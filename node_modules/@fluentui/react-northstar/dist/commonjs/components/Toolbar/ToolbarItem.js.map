{"version":3,"file":"ToolbarItem.js","names":["_accessibility","require","_reactBindings","_reactComponentRef","_reactComponentEventListener","_reactComponentNestingRegistry","customPropTypes","_interopRequireWildcard","PropTypes","React","_utils","_positioner","_ToolbarMenu","_Popup","_toolbarVariablesContext","_ToolbarItemWrapper","_ToolbarItemIcon","_toolbarMenuContext","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","toolbarItemClassName","exports","ToolbarItem","compose","props","ref","composeOptions","context","useFluentContext","_useTelemetry","useTelemetry","displayName","telemetry","setStart","setEnd","accessibility","active","className","design","icon","children","disabled","disabledFocusable","popup","menuOpen","wrapper","styles","variables","_partitionPopperProps","partitionPopperPropsFromShorthand","menu","positioningProps","itemRef","useRef","menuRef","parentVariables","useContext","ToolbarVariablesContext","mergedVariables","mergeVariablesOverrides","_ref","useContextSelectors","ToolbarMenuContext","menuSlot","v","slots","getA11yProps","useAccessibility","debugName","actionHandlers","performClick","event","preventDefault","handleClick","performWrapperClick","handleWrapperClick","closeMenuAndFocusTrigger","trySetMenuOpen","_invoke2","current","doNotNavigateNextToolbarItem","stopPropagation","mapPropsToBehavior","as","String","hasMenu","hasPopup","rtl","_useStyles","useStyles","mapPropsToStyles","mapPropsToInlineStyles","unstable_props","classes","handleBlur","e","handleFocus","doesNodeContainClick","nativeEvent","target","handleOutsideClick","getRefs","isItemClick","isNestedClick","_some2","childRef","isInside","newValue","assign","handleMenuOverrides","predefinedProps","onBlur","isInsideOrMenuTrigger","contains","relatedTarget","onItemClick","itemProps","ElementType","getElementType","slotProps","resolveSlotProps","unhandledProps","useUnhandledProps","handledProps","itemElement","createElement","Ref","innerRef","node","handleRef","root","onFocus","onClick","childrenExist","createShorthand","submenuElement","Unstable_NestingAuto","nestingRef","Fragment","Popper","_extends2","align","position","targetRef","ToolbarVariablesProvider","value","ToolbarMenu","defaultProps","overrideProps","EventListener","listener","type","capture","popupElement","trigger","undefined","contentElement","wrapperElement","ToolbarItemIcon","ToolbarItemWrapper","Popup","trapFocus","shorthandConfig","mappedProp","propTypes","commonPropTypes","createCommon","bool","shorthandAllowingChildren","oneOfType","arrayOf","onMenuOpenChange","func","shape","never","string","toolbarItemBehavior"],"sources":["components/Toolbar/ToolbarItem.tsx"],"sourcesContent":["import { Accessibility, toolbarItemBehavior, ToolbarItemBehaviorProps } from '@fluentui/accessibility';\nimport {\n  compose,\n  getElementType,\n  mergeVariablesOverrides,\n  useUnhandledProps,\n  useFluentContext,\n  useAccessibility,\n  useStyles,\n  useTelemetry,\n  useContextSelectors,\n} from '@fluentui/react-bindings';\nimport { handleRef, Ref } from '@fluentui/react-component-ref';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { GetRefs, NodeRef, Unstable_NestingAuto } from '@fluentui/react-component-nesting-registry';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport {\n  createShorthand,\n  doesNodeContainClick,\n  UIComponentProps,\n  ChildrenComponentProps,\n  ContentComponentProps,\n  commonPropTypes,\n  childrenExist,\n} from '../../utils';\nimport { ComponentEventHandler, ShorthandValue, ShorthandCollection } from '../../types';\nimport { partitionPopperPropsFromShorthand, Popper, PopperShorthandProps } from '../../utils/positioner';\n\nimport { ToolbarMenu, ToolbarMenuProps } from './ToolbarMenu';\nimport { Popup, PopupProps } from '../Popup/Popup';\nimport { ToolbarMenuItemProps } from '../Toolbar/ToolbarMenuItem';\nimport { ToolbarItemShorthandKinds } from './Toolbar';\nimport { ToolbarVariablesContext, ToolbarVariablesProvider } from './toolbarVariablesContext';\nimport { ToolbarItemWrapper, ToolbarItemWrapperProps } from './ToolbarItemWrapper';\nimport { ToolbarItemIcon, ToolbarItemIconProps } from './ToolbarItemIcon';\nimport { ToolbarItemSubscribedValue, ToolbarMenuContext } from './toolbarMenuContext';\n\nexport interface ToolbarItemProps extends UIComponentProps, ChildrenComponentProps, ContentComponentProps {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<ToolbarItemBehaviorProps>;\n\n  /** A toolbar item can be active. */\n  active?: boolean;\n\n  /** A toolbar item can show it is currently unable to be interacted with. */\n  disabled?: boolean;\n\n  /** A toolbar item can be disabled and focusable at the same time. */\n  disabledFocusable?: boolean;\n\n  /** Name or shorthand for Toolbar Item Icon */\n  icon?: ShorthandValue<ToolbarItemIconProps>;\n\n  /**\n   * Shorthand for the submenu.\n   * If submenu is specified, the item is wrapped to group the item and the menu elements together.\n   */\n  menu?:\n    | ShorthandValue<ToolbarMenuProps & { popper?: PopperShorthandProps }>\n    | ShorthandCollection<ToolbarMenuItemProps, ToolbarItemShorthandKinds>;\n\n  /** Indicates if the menu inside the item is open. */\n  menuOpen?: boolean;\n\n  /**\n   * Event for request to change 'menuOpen' value.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props and proposed value.\n   */\n  onMenuOpenChange?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called on click.\n   *\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onClick?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called after user's focus.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onFocus?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called after item blur.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onBlur?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Attaches a `Popup` component to the ToolbarItem.\n   * Accepts all props as a `Popup`, except `trigger` and `children`.\n   * Traps focus by default.\n   * @see PopupProps\n   */\n  popup?: Omit<PopupProps, 'trigger' | 'children'> | string;\n\n  /** Shorthand for the wrapper component. The item is wrapped only if it contains a menu! */\n  wrapper?: ShorthandValue<ToolbarItemWrapperProps>;\n}\n\nexport type ToolbarItemStylesProps = Required<Pick<ToolbarItemProps, 'active' | 'disabled' | 'disabledFocusable'>>;\n\nexport const toolbarItemClassName = 'ui-toolbar__item';\n\n/**\n * A ToolbarItem renders Toolbar item as a button with an icon.\n */\nexport const ToolbarItem = compose<'button', ToolbarItemProps, ToolbarItemStylesProps, {}, {}>(\n  (props, ref, composeOptions) => {\n    const context = useFluentContext();\n    const { setStart, setEnd } = useTelemetry(composeOptions.displayName, context.telemetry);\n    setStart();\n\n    const {\n      accessibility,\n      active,\n      className,\n      design,\n      icon,\n      children,\n      disabled,\n      disabledFocusable,\n      popup,\n      menuOpen,\n      wrapper,\n      styles,\n      variables,\n    } = props;\n    const [menu, positioningProps] = partitionPopperPropsFromShorthand(props.menu);\n\n    const itemRef = React.useRef<HTMLElement>();\n    const menuRef = React.useRef<HTMLElement>();\n\n    const parentVariables = React.useContext(ToolbarVariablesContext);\n    const mergedVariables = mergeVariablesOverrides(parentVariables, variables);\n\n    const { menuSlot } = useContextSelectors(ToolbarMenuContext, {\n      menuSlot: v => v.slots.menu,\n    }) as unknown as ToolbarItemSubscribedValue; // TODO: we should improve typings for the useContextSelectors\n\n    const getA11yProps = useAccessibility(accessibility, {\n      debugName: composeOptions.displayName,\n      actionHandlers: {\n        performClick: event => {\n          event.preventDefault();\n          handleClick(event);\n        },\n        performWrapperClick: event => {\n          handleWrapperClick(event);\n        },\n        closeMenuAndFocusTrigger: event => {\n          trySetMenuOpen(false, event);\n          _.invoke(itemRef.current, 'focus');\n        },\n        doNotNavigateNextToolbarItem: event => {\n          event.stopPropagation();\n        },\n      },\n      mapPropsToBehavior: () => ({\n        as: String(props.as),\n        disabled,\n        disabledFocusable,\n        hasMenu: !!menu,\n        hasPopup: !!popup,\n        menuOpen,\n        active,\n      }),\n      rtl: context.rtl,\n    });\n    const { classes } = useStyles<ToolbarItemStylesProps>(composeOptions.displayName, {\n      className: composeOptions.className,\n      composeOptions,\n      mapPropsToStyles: () => ({ active, disabled, disabledFocusable }),\n      mapPropsToInlineStyles: () => ({\n        className,\n        design,\n        styles,\n        variables: mergedVariables,\n      }),\n      rtl: context.rtl,\n      unstable_props: props,\n    });\n\n    const handleBlur = (e: React.SyntheticEvent) => {\n      _.invoke(props, 'onBlur', e, props);\n    };\n\n    const handleFocus = (e: React.SyntheticEvent) => {\n      _.invoke(props, 'onFocus', e, props);\n    };\n\n    const handleClick = (e: React.MouseEvent | React.KeyboardEvent) => {\n      if (disabled || disabledFocusable) {\n        e.preventDefault();\n        return;\n      }\n\n      if (menu) {\n        trySetMenuOpen(!menuOpen, e);\n      }\n\n      _.invoke(props, 'onClick', e, props);\n    };\n\n    const handleWrapperClick = (e: React.MouseEvent | React.KeyboardEvent) => {\n      if (menu) {\n        if (doesNodeContainClick(menuRef.current, e.nativeEvent as MouseEvent, context.target, false)) {\n          trySetMenuOpen(false, e);\n        }\n      }\n    };\n\n    const handleOutsideClick = (getRefs: GetRefs) => (e: MouseEvent) => {\n      const isItemClick = doesNodeContainClick(itemRef.current, e, context.target);\n      const isNestedClick = _.some(getRefs(), (childRef: NodeRef) => {\n        return doesNodeContainClick(childRef.current as HTMLElement, e, context.target);\n      });\n      const isInside = isItemClick || isNestedClick;\n\n      if (!isInside) {\n        trySetMenuOpen(false, e);\n      }\n    };\n\n    const trySetMenuOpen = (newValue: boolean, e: Event | React.SyntheticEvent) => {\n      _.invoke(props, 'onMenuOpenChange', e, { ...props, menuOpen: newValue });\n    };\n\n    const handleMenuOverrides = (getRefs: GetRefs) => (predefinedProps: ToolbarMenuProps) => ({\n      onBlur: (e: React.FocusEvent) => {\n        const isInsideOrMenuTrigger = _.some(getRefs(), (childRef: NodeRef) => {\n          return (\n            childRef.current.contains(e.relatedTarget as HTMLElement) ||\n            itemRef.current.contains(e.relatedTarget as HTMLElement)\n          );\n        });\n\n        if (!isInsideOrMenuTrigger) {\n          trySetMenuOpen(false, e);\n        }\n      },\n      onItemClick: (e, itemProps: ToolbarMenuItemProps) => {\n        const { popup, menuOpen } = itemProps;\n        _.invoke(predefinedProps, 'onItemClick', e, itemProps);\n        if (popup) {\n          return;\n        }\n        // TODO: should we pass toolbarMenuItem to the user callback so he can decide if he wants to close the menu?\n        trySetMenuOpen(menuOpen, e);\n      },\n    });\n\n    const ElementType = getElementType(props);\n    const slotProps = composeOptions.resolveSlotProps<ToolbarItemProps>(props);\n    const unhandledProps = useUnhandledProps(composeOptions.handledProps, props);\n\n    const itemElement = (\n      <Ref\n        innerRef={node => {\n          itemRef.current = node;\n          handleRef(ref, node);\n        }}\n      >\n        <ElementType\n          {...getA11yProps('root', {\n            ...unhandledProps,\n            disabled,\n            className: classes.root,\n            onBlur: handleBlur,\n            onFocus: handleFocus,\n            onClick: handleClick,\n          })}\n        >\n          {childrenExist(children) ? children : createShorthand(composeOptions.slots.icon, icon, slotProps.icon)}\n        </ElementType>\n      </Ref>\n    );\n\n    const submenuElement = menuOpen ? (\n      <Unstable_NestingAuto>\n        {(getRefs, nestingRef) => {\n          return (\n            <>\n              <Ref\n                innerRef={(node: HTMLElement) => {\n                  nestingRef.current = node;\n                  menuRef.current = node;\n                }}\n              >\n                <Popper align=\"start\" position=\"above\" targetRef={itemRef} {...positioningProps}>\n                  <ToolbarVariablesProvider value={mergedVariables}>\n                    {createShorthand(composeOptions.slots.menu || menuSlot || ToolbarMenu, menu, {\n                      defaultProps: () => slotProps.menu,\n                      overrideProps: handleMenuOverrides(getRefs),\n                    })}\n                  </ToolbarVariablesProvider>\n                </Popper>\n              </Ref>\n              <EventListener listener={handleOutsideClick(getRefs)} target={context.target} type=\"click\" capture />\n            </>\n          );\n        }}\n      </Unstable_NestingAuto>\n    ) : null;\n\n    if (popup) {\n      const popupElement = createShorthand(composeOptions.slots.popup, popup, {\n        defaultProps: () => slotProps.popup,\n        overrideProps: {\n          trigger: itemElement,\n          children: undefined, // force-reset `children` defined for `Popup` as it collides with the `trigger`\n        },\n      });\n      setEnd();\n\n      return popupElement;\n    }\n\n    // wrap the item if it has menu (even if it is closed = not rendered)\n    if (menu) {\n      const contentElement = (\n        <>\n          {itemElement}\n          {submenuElement}\n        </>\n      );\n\n      if (wrapper) {\n        const wrapperElement = createShorthand(composeOptions.slots.wrapper, wrapper, {\n          defaultProps: () => getA11yProps('wrapper', slotProps.wrapper || {}),\n          overrideProps: predefinedProps => ({\n            children: contentElement,\n            onClick: e => {\n              handleWrapperClick(e);\n              _.invoke(predefinedProps, 'onClick', e);\n            },\n          }),\n        });\n        setEnd();\n\n        return wrapperElement;\n      }\n\n      setEnd();\n      return contentElement;\n    }\n\n    setEnd();\n\n    return itemElement;\n  },\n  {\n    className: toolbarItemClassName,\n    displayName: 'ToolbarItem',\n\n    slots: {\n      icon: ToolbarItemIcon,\n      wrapper: ToolbarItemWrapper,\n      popup: Popup, // TODO: compose Popup to ToolbarItemPopup once it has compose functionality\n    },\n\n    slotProps: () => ({\n      popup: { trapFocus: true },\n    }),\n\n    shorthandConfig: { mappedProp: 'content' },\n    handledProps: [\n      'accessibility',\n      'as',\n      'children',\n      'className',\n      'content',\n      'design',\n      'styles',\n      'disabledFocusable',\n      'variables',\n      'active',\n      'disabled',\n      'icon',\n      'menu',\n      'menuOpen',\n      'onMenuOpenChange',\n      'onClick',\n      'onFocus',\n      'onBlur',\n      'popup',\n      'wrapper',\n    ],\n  },\n);\n\nToolbarItem.propTypes = {\n  ...commonPropTypes.createCommon(),\n  active: PropTypes.bool,\n  disabled: PropTypes.bool,\n  disabledFocusable: PropTypes.bool,\n  icon: customPropTypes.shorthandAllowingChildren,\n  menu: PropTypes.oneOfType([\n    customPropTypes.shorthandAllowingChildren,\n    PropTypes.arrayOf(customPropTypes.shorthandAllowingChildren),\n  ]),\n  menuOpen: PropTypes.bool,\n  onMenuOpenChange: PropTypes.func,\n  onClick: PropTypes.func,\n  onFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n  popup: PropTypes.oneOfType([\n    PropTypes.shape({\n      ...Popup.propTypes,\n      trigger: customPropTypes.never,\n      children: customPropTypes.never,\n    }),\n    PropTypes.string,\n  ]),\n  wrapper: customPropTypes.shorthandAllowingChildren,\n};\nToolbarItem.defaultProps = {\n  as: 'button',\n  accessibility: toolbarItemBehavior,\n  wrapper: {},\n};\n"],"mappings":"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"}