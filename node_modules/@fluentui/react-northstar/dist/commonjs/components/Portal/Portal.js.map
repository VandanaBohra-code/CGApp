{"version":3,"file":"Portal.js","names":["_reactBindings","require","_reactComponentEventListener","_reactComponentRef","customPropTypes","_interopRequireWildcard","PropTypes","React","_utils","_PortalInner","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","Portal","props","context","useFluentContext","_useTelemetry","useTelemetry","displayName","telemetry","setStart","setEnd","children","content","trapFocus","trigger","triggerAccessibility","portalRef","useRef","triggerRef","_useAutoControlled","useAutoControlled","defaultValue","defaultOpen","value","open","initialValue","setOpen","renderPortal","contentToRender","childrenExist","focusTrapZoneProps","_keys2","length","createElement","Ref","innerRef","PortalInner","_extends2","onMount","handleMount","onUnmount","handleUnmount","rtlTextContainer","getAttributes","forElements","FocusTrapZone","EventListener","listener","handleDocumentClick","target","type","renderTrigger","handleTriggerRef","cloneElement","assign","onClick","handleTriggerClick","attributes","keyHandlers","_invoke2","node","current","handleRef","e","_len","arguments","unhandledProps","Array","_key","apply","concat","isOpen","doesNodeContainClick","element","Fragment","exports","propTypes","commonPropTypes","createCommon","accessibility","as","className","styled","bool","func","ref","object","onTriggerClick","onOutsideClick","oneOfType","handledProps","keys","create","createShorthandFactory","Component","defaultProps"],"sources":["components/Portal/Portal.tsx"],"sourcesContent":["import { AccessibilityAttributes } from '@fluentui/accessibility';\nimport {\n  AccessibilityHandlerProps,\n  FocusTrapZone,\n  FocusTrapZoneProps,\n  useFluentContext,\n  useTelemetry,\n  useAutoControlled,\n} from '@fluentui/react-bindings';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { handleRef, Ref } from '@fluentui/react-component-ref';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport * as _ from 'lodash';\nimport { FluentComponentStaticProps } from '../../types';\nimport {\n  childrenExist,\n  doesNodeContainClick,\n  ChildrenComponentProps,\n  commonPropTypes,\n  ContentComponentProps,\n  rtlTextContainer,\n  createShorthandFactory,\n} from '../../utils';\nimport { PortalInner } from './PortalInner';\n\nexport type TriggerAccessibility = {\n  attributes?: AccessibilityAttributes;\n  keyHandlers?: AccessibilityHandlerProps;\n};\n\nexport interface PortalProps extends ChildrenComponentProps, ContentComponentProps {\n  /** Initial value of open. */\n  defaultOpen?: boolean;\n\n  /**\n   * Called when the portal is mounted on the DOM.\n   *\n   * @param data - All props.\n   */\n  onMount?: (props: PortalProps) => void;\n\n  /**\n   * Called when the portal is unmounted from the DOM.\n   *\n   * @param data - All props.\n   */\n  onUnmount?: (props: PortalProps) => void;\n\n  /** Controls whether or not the portal is displayed. */\n  open?: boolean;\n\n  /** Element to be rendered in-place where the portal is defined. */\n  trigger?: JSX.Element;\n\n  /** Controls whether or not focus trap should be applied, using boolean or FocusTrapZoneProps type value */\n  trapFocus?: FocusTrapZoneProps | boolean;\n\n  /** Accessibility behavior object to apply on trigger node. */\n  triggerAccessibility?: TriggerAccessibility;\n\n  /** Sets trigger node to passed ref. */\n  triggerRef?: React.Ref<any>;\n\n  /**\n   * Called when trigger node was clicked.\n   *\n   * @param data - All props.\n   */\n  onTriggerClick?: (e: React.MouseEvent) => void;\n\n  /**\n   * Called when `click` event was invoked outside portal or trigger nodes.\n   *\n   * @param data - All props.\n   */\n  onOutsideClick?: (e: React.MouseEvent) => void;\n}\n\n/**\n * (DEPRECATED) A Portal allows to render children outside of their parent.\n *\n * @deprecated Please use \"Popup\" or \"Dialog\" components instead.\n */\nexport const Portal: React.FC<PortalProps> & FluentComponentStaticProps<PortalProps> = props => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(Portal.displayName, context.telemetry);\n  setStart();\n  const { children, content, trapFocus, trigger, triggerAccessibility } = props;\n  const portalRef = React.useRef<HTMLElement>();\n  const triggerRef = React.useRef<HTMLElement>();\n\n  const [open, setOpen] = useAutoControlled({\n    defaultValue: props.defaultOpen,\n    value: props.open,\n    initialValue: false,\n  });\n\n  const renderPortal = (): JSX.Element | undefined => {\n    const contentToRender = childrenExist(children) ? children : content;\n    const focusTrapZoneProps = (_.keys(trapFocus).length && trapFocus) || {};\n    return (\n      open && (\n        <Ref innerRef={portalRef}>\n          <PortalInner\n            onMount={handleMount}\n            onUnmount={handleUnmount}\n            {...rtlTextContainer.getAttributes({ forElements: [contentToRender] })}\n          >\n            {trapFocus ? <FocusTrapZone {...focusTrapZoneProps}>{contentToRender}</FocusTrapZone> : contentToRender}\n            <EventListener listener={handleDocumentClick} target={context.target} type=\"click\" />\n          </PortalInner>\n        </Ref>\n      )\n    );\n  };\n\n  const renderTrigger = (): JSX.Element | undefined => {\n    return (\n      trigger && (\n        <Ref innerRef={handleTriggerRef}>\n          {React.cloneElement(trigger, {\n            onClick: handleTriggerClick,\n            ...triggerAccessibility.attributes,\n            ...triggerAccessibility.keyHandlers,\n          })}\n        </Ref>\n      )\n    );\n  };\n\n  const handleMount = () => {\n    _.invoke(props, 'onMount', props);\n  };\n\n  const handleUnmount = () => {\n    _.invoke(props, 'onUnmount', props);\n  };\n\n  const handleTriggerRef = (node: HTMLElement) => {\n    triggerRef.current = node;\n    handleRef(props.triggerRef, node);\n  };\n\n  const handleTriggerClick = (e: React.MouseEvent, ...unhandledProps) => {\n    _.invoke(props, 'onTriggerClick', e); // Call handler from parent component\n    _.invoke(trigger, 'props.onClick', e, ...unhandledProps); // Call original event handler\n    setOpen(isOpen => !isOpen);\n  };\n\n  const handleDocumentClick = (e: MouseEvent) => {\n    if (\n      !portalRef || // no portal\n      doesNodeContainClick(triggerRef.current, e, context.target) || // event happened in trigger (delegate to trigger handlers)\n      doesNodeContainClick(portalRef.current, e, context.target) // event happened in the portal\n    ) {\n      return; // ignore the click\n    }\n    _.invoke(props, 'onOutsideClick', e);\n    setOpen(false);\n  };\n\n  const element = (\n    <>\n      {renderPortal()}\n      {renderTrigger()}\n    </>\n  );\n  setEnd();\n  return element;\n};\n\nPortal.propTypes = {\n  ...commonPropTypes.createCommon({\n    accessibility: false,\n    as: false,\n    className: false,\n    styled: false,\n  }),\n  defaultOpen: PropTypes.bool,\n  onMount: PropTypes.func,\n  onUnmount: PropTypes.func,\n  open: PropTypes.bool,\n  trigger: PropTypes.element,\n  triggerRef: customPropTypes.ref,\n  triggerAccessibility: PropTypes.object,\n  onTriggerClick: PropTypes.func,\n  onOutsideClick: PropTypes.func,\n  trapFocus: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n};\n\nPortal.handledProps = Object.keys(Portal.propTypes) as any;\n\nPortal.create = createShorthandFactory({\n  Component: Portal,\n});\n\nPortal.defaultProps = {\n  triggerAccessibility: {},\n};\n"],"mappings":"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"}