{"version":3,"file":"Debug.js","names":["_accessibility","require","PropTypes","_interopRequireWildcard","React","_reactComponentEventListener","_utils","_styles","_DebugPanel","_FiberNavigator","_DebugRect","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","INITIAL_STATE","fiberNav","selectedFiberNav","isSelecting","Debug","_React$Component","_inheritsLoose2","p","s","_this","state","debugReactComponent","r","console","error","_reactInternalFiber","fluentUIDebug","FiberNavigator","fromFiber","setState","debugDOMNode","domNode","fromDOMNode","findOwner","fiber","handleKeyDown","e","code","getCode","keyboardKey","Escape","stopSelecting","d","altKey","shiftKey","startSelecting","handleMouseMove","target","handleDOMNodeClick","preventDefault","stopPropagation","assign","selectFiber","changeFiber","positionRight","debugPanelPosition","positionLeft","close","process","env","NODE_ENV","isDebugEnabled","isBrowser","window","openDebugPanel","$r","_proto","render","mountDocument","props","_this$state","createElement","Fragment","EventListener","listener","body","type","DebugRect","instance","DebugPanel","onActivateDebugSelectorClick","onClose","debugData","position","onPositionLeft","onPositionRight","onFiberChanged","onFiberSelected","Component","exports","defaultProps","document","propTypes","object","isRequired"],"sources":["components/Debug/Debug.tsx"],"sourcesContent":["import { getCode, keyboardKey } from '@fluentui/accessibility';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { EventListener } from '@fluentui/react-component-event-listener';\n\nimport { isBrowser } from '../../utils';\nimport { isDebugEnabled } from '@fluentui/styles';\n\nimport { DebugPanel } from './DebugPanel';\nimport { FiberNavigator } from './FiberNavigator';\nimport { DebugRect } from './DebugRect';\n\n/* eslint-disable no-console */\n\nexport type DebugProps = {\n  /** Existing document the popup should add listeners. */\n  mountDocument?: Document;\n};\n\nexport type DebugState = {\n  debugPanelPosition?: 'left' | 'right';\n  fiberNav: FiberNavigator;\n  selectedFiberNav: FiberNavigator;\n  isSelecting: boolean;\n};\n\nconst INITIAL_STATE: DebugState = {\n  fiberNav: null,\n  selectedFiberNav: null,\n  isSelecting: false,\n};\n\nexport class Debug extends React.Component<DebugProps, DebugState> {\n  state = INITIAL_STATE;\n\n  static defaultProps = {\n    // eslint-disable-next-line no-undef\n    mountDocument: isBrowser() ? window.document : null,\n  };\n\n  static propTypes = {\n    mountDocument: PropTypes.object.isRequired,\n  };\n\n  constructor(p, s) {\n    super(p, s);\n    if (process.env.NODE_ENV !== 'production' && isDebugEnabled && isBrowser()) {\n      // eslint-disable-next-line no-undef\n      (window as any).openDebugPanel = () => {\n        // eslint-disable-next-line no-undef\n        this.debugReactComponent((window as any).$r);\n      };\n    }\n  }\n\n  debugReactComponent = r => {\n    if (!r) {\n      console.error(\n        \"No React component selected. Please select a Fluent UI component from the React's Component panel.\",\n      );\n      return;\n    }\n    if (!r._reactInternalFiber) {\n      console.error(\n        'React does not provide data for debugging for this component. Try selecting some Fluent UI component.',\n      );\n      return;\n    }\n    if (!r.fluentUIDebug) {\n      console.error('Not a debuggable component. Try selecting some Fluent UI component.');\n      return;\n    }\n\n    const fiberNav = FiberNavigator.fromFiber(r._reactInternalFiber);\n    this.setState({ fiberNav, isSelecting: false, selectedFiberNav: null });\n  };\n\n  debugDOMNode = domNode => {\n    let fiberNav = FiberNavigator.fromDOMNode(domNode);\n\n    if (!fiberNav) {\n      console.error('No fiber for dom node', domNode);\n      return;\n    }\n\n    fiberNav = fiberNav.findOwner(fiber => fiber.fluentUIDebug);\n\n    if (fiberNav !== this.state.fiberNav) {\n      this.setState({ fiberNav });\n    }\n  };\n\n  handleKeyDown = e => {\n    const code = getCode(e);\n\n    switch (code) {\n      case keyboardKey.Escape:\n        this.stopSelecting();\n        break;\n\n      case keyboardKey.d:\n        if (e.altKey && e.shiftKey) {\n          this.startSelecting();\n        }\n        break;\n    }\n  };\n\n  handleMouseMove = e => {\n    this.debugDOMNode(e.target);\n  };\n\n  handleDOMNodeClick = e => {\n    e.preventDefault();\n    e.stopPropagation();\n\n    this.setState({ isSelecting: false });\n  };\n\n  startSelecting = () => {\n    const isSelecting = !this.state.isSelecting;\n\n    this.setState({\n      ...(!isSelecting && INITIAL_STATE),\n      isSelecting,\n    });\n  };\n\n  stopSelecting = () => {\n    this.setState(INITIAL_STATE);\n  };\n\n  selectFiber = selectedFiberNav => this.setState({ selectedFiberNav });\n\n  changeFiber = fiberNav => this.setState({ fiberNav });\n\n  positionRight = () => this.setState({ debugPanelPosition: 'right' });\n\n  positionLeft = () => this.setState({ debugPanelPosition: 'left' });\n\n  close = () => this.setState(INITIAL_STATE);\n\n  render() {\n    const { mountDocument } = this.props;\n    const { fiberNav, selectedFiberNav, isSelecting, debugPanelPosition } = this.state;\n\n    if (process.env.NODE_ENV !== 'production' && isDebugEnabled) {\n      return (\n        <>\n          <EventListener listener={this.handleKeyDown} target={mountDocument.body} type=\"keydown\" />\n          {isSelecting && (\n            <EventListener listener={this.handleMouseMove} target={mountDocument.body} type=\"mousemove\" />\n          )}\n          {isSelecting && fiberNav && fiberNav.domNode && (\n            <EventListener listener={this.handleDOMNodeClick} target={fiberNav.domNode} type=\"click\" />\n          )}\n          {isSelecting && fiberNav && <DebugRect fiberNav={fiberNav} />}\n          {selectedFiberNav && <DebugRect fiberNav={selectedFiberNav} />}\n          {!isSelecting && fiberNav && fiberNav.instance && (\n            <DebugPanel\n              fiberNav={fiberNav}\n              onActivateDebugSelectorClick={this.startSelecting}\n              onClose={this.close}\n              // TODO: Integrate CSS in JS Styles for Host Components (DOM nodes)\n              // cssStyles={stylesForNode(domNode)}\n              debugData={fiberNav.fluentUIDebug}\n              position={debugPanelPosition || 'right'}\n              onPositionLeft={this.positionLeft}\n              onPositionRight={this.positionRight}\n              onFiberChanged={this.changeFiber}\n              onFiberSelected={this.selectFiber}\n            />\n          )}\n        </>\n      );\n    }\n\n    return null;\n  }\n}\n"],"mappings":"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"}