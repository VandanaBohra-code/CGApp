{"version":3,"file":"Dialog.js","names":["_accessibility","require","_reactBindings","_reactComponentNestingRegistry","_reactComponentEventListener","_reactComponentRef","customPropTypes","_interopRequireWildcard","PropTypes","React","_bodyScrollLock","_utils","_Button","_ButtonGroup","_Box","_Header","_Portal","_Flex","_DialogFooter","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","dialogClassName","exports","dialogSlotClassNames","header","headerAction","content","overlay","footer","Dialog","forwardRef","props","ref","context","useFluentContext","_useTelemetry","useTelemetry","displayName","telemetry","setStart","setEnd","accessibility","actions","cancelButton","closeOnOutsideClick","confirmButton","trapFocus","trigger","backdrop","className","design","styles","variables","ElementType","getElementType","unhandledProps","useUnhandledProps","handledProps","contentRef","useRef","overlayRef","triggerRef","contentId","current","getOrGenerateIdFromShorthand","headerId","getA11yProps","useAccessibility","debugName","actionHandlers","closeAndFocusTrigger","e","handleDialogCancel","stopPropagation","_invoke2","close","mapPropsToBehavior","rtl","_useStyles","useStyles","mapPropsToStyles","mapPropsToInlineStyles","classes","resolvedStyles","_useAutoControlled","useAutoControlled","defaultValue","defaultOpen","value","open","initialValue","setOpen","useEffect","target","disableBodyScroll","enableBodyScroll","assign","handleDialogConfirm","handleDialogOpen","handleCancelButtonOverrides","predefinedProps","onClick","buttonProps","handleConfirmButtonOverrides","isMouseDownInsideContent","registerMouseDownOnDialogContent","button","onMouseDown","handleOverlayClick","isInsideContentClick","doesNodeContainClick","isInsideOverlayClick","shouldClose","handleDocumentKeydown","getRefs","lastOverlayRef","pop","isLastOpenedDialog","targetIsBody","nodeName","getCode","keyboardKey","Escape","cancelElement","createShorthand","Button","overrideProps","confirmElement","defaultProps","primary","dialogActions","ButtonGroup","create","createElement","Flex","gap","hAlign","dialogContent","Ref","innerRef","root","Header","as","text","iconOnly","Box","DialogFooter","triggerAccessibility","attributes","keyHandlers","keyActions","element","Portal","onTriggerClick","Unstable_NestingAuto","nestingRef","Fragment","contentNode","EventListener","listener","type","capture","propTypes","commonPropTypes","createCommon","children","itemShorthand","bool","onCancel","func","onConfirm","onOpen","oneOfType","object","any","dialogBehavior","keys","Footer","createShorthandFactory","Component"],"sources":["components/Dialog/Dialog.tsx"],"sourcesContent":["import { Accessibility, dialogBehavior, DialogBehaviorProps, getCode, keyboardKey } from '@fluentui/accessibility';\nimport {\n  FocusTrapZoneProps,\n  useAutoControlled,\n  useTelemetry,\n  useAccessibility,\n  useStyles,\n  useFluentContext,\n  useUnhandledProps,\n  getElementType,\n  ForwardRefWithAs,\n} from '@fluentui/react-bindings';\nimport { Unstable_NestingAuto } from '@fluentui/react-component-nesting-registry';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { Ref } from '@fluentui/react-component-ref';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport { disableBodyScroll, enableBodyScroll } from 'body-scroll-lock';\n\nimport {\n  UIComponentProps,\n  commonPropTypes,\n  ContentComponentProps,\n  doesNodeContainClick,\n  getOrGenerateIdFromShorthand,\n  createShorthand,\n  createShorthandFactory,\n} from '../../utils';\nimport { ComponentEventHandler, ShorthandValue, FluentComponentStaticProps } from '../../types';\nimport { Button, ButtonProps } from '../Button/Button';\nimport { ButtonGroup } from '../Button/ButtonGroup';\nimport { Box, BoxProps } from '../Box/Box';\nimport { Header, HeaderProps } from '../Header/Header';\nimport { Portal, TriggerAccessibility } from '../Portal/Portal';\nimport { Flex } from '../Flex/Flex';\nimport { DialogFooter, DialogFooterProps } from './DialogFooter';\n\nexport interface DialogSlotClassNames {\n  header: string;\n  headerAction: string;\n  content: string;\n  overlay: string;\n  footer: string;\n}\n\nexport interface DialogProps extends UIComponentProps, ContentComponentProps<ShorthandValue<BoxProps>> {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility;\n\n  /** A dialog can contain actions. */\n  actions?: ShorthandValue<BoxProps>;\n\n  /** A dialog can have a backdrop on its overlay. */\n  backdrop?: boolean;\n\n  /** A dialog can contain a cancel button. */\n  cancelButton?: ShorthandValue<ButtonProps>;\n\n  /** A dialog can be closed when a user clicks outside of it. */\n  closeOnOutsideClick?: boolean;\n\n  /** A dialog can contain a confirm button. */\n  confirmButton?: ShorthandValue<ButtonProps>;\n\n  /** A dialog can be open by default. */\n  defaultOpen?: boolean;\n\n  /** A dialog can contain a header. */\n  header?: ShorthandValue<HeaderProps>;\n\n  /** A dialog can contain a button next to the header. */\n  headerAction?: ShorthandValue<ButtonProps>;\n\n  /** A dialog can contain a footer. */\n  footer?: ShorthandValue<DialogFooterProps>;\n\n  /**\n   * Called after a user clicks the cancel button.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onCancel?: ComponentEventHandler<DialogProps>;\n\n  /**\n   * Called after a user clicks the confirm button.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onConfirm?: ComponentEventHandler<DialogProps>;\n\n  /**\n   * Called after a user opens the dialog.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onOpen?: ComponentEventHandler<DialogProps>;\n\n  /** A dialog's open state can be controlled. */\n  open?: boolean;\n\n  /** A dialog can contain a overlay. */\n  overlay?: ShorthandValue<BoxProps>;\n\n  /** Controls whether or not focus trap should be applied, using boolean or FocusTrapZoneProps type value. */\n  trapFocus?: boolean | FocusTrapZoneProps;\n\n  /** Element to be rendered in-place where the dialog is defined. */\n  trigger?: JSX.Element;\n}\n\nexport interface DialogState {\n  contentId?: string;\n  headerId?: string;\n  open?: boolean;\n}\n\nexport const dialogClassName = 'ui-dialog';\nexport const dialogSlotClassNames: DialogSlotClassNames = {\n  header: `${dialogClassName}__header`,\n  headerAction: `${dialogClassName}__headerAction`,\n  content: `${dialogClassName}__content`,\n  overlay: `${dialogClassName}__overlay`,\n  footer: `${dialogClassName}__footer`,\n};\n\nexport type DialogStylesProps = Required<Pick<DialogProps, 'backdrop'>>;\n\n/**\n * A Dialog displays important information on top of a page which requires a user's attention, confirmation, or interaction.\n * Dialogs are purposefully interruptive, so they should be used sparingly.\n *\n * @accessibility\n * Implements [ARIA Dialog (Modal)](https://www.w3.org/TR/wai-aria-practices-1.1/#dialog_modal) design pattern.\n * @accessibilityIssues\n * [NVDA narrates dialog title and button twice](https://github.com/nvaccess/nvda/issues/10003)\n * [NVDA does not recognize the ARIA 1.1 values of aria-haspopup](https://github.com/nvaccess/nvda/issues/8235)\n * [Jaws does not announce token values of aria-haspopup](https://github.com/FreedomScientific/VFO-standards-support/issues/33)\n * [Issue 989517: VoiceOver narrates dialog content and button twice](https://bugs.chromium.org/p/chromium/issues/detail?id=989517)\n */\nexport const Dialog = React.forwardRef<HTMLDivElement, DialogProps>((props, ref) => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(Dialog.displayName, context.telemetry);\n  setStart();\n\n  const {\n    accessibility,\n    content,\n    header,\n    actions,\n    cancelButton,\n    closeOnOutsideClick,\n    confirmButton,\n    headerAction,\n    overlay,\n    trapFocus,\n    trigger,\n    footer,\n    backdrop,\n    className,\n    design,\n    styles,\n    variables,\n  } = props;\n\n  const ElementType = getElementType(props);\n  const unhandledProps = useUnhandledProps(Dialog.handledProps, props);\n\n  const contentRef = React.useRef<HTMLElement>();\n  const overlayRef = React.useRef<HTMLElement>();\n  const triggerRef = React.useRef<HTMLElement>();\n\n  const contentId = React.useRef<string>();\n  contentId.current = getOrGenerateIdFromShorthand('dialog-content-', content, contentId.current);\n  const headerId = React.useRef<string>();\n  headerId.current = getOrGenerateIdFromShorthand('dialog-header-', header, headerId.current);\n\n  const getA11yProps = useAccessibility<DialogBehaviorProps>(accessibility, {\n    debugName: Dialog.displayName,\n    actionHandlers: {\n      closeAndFocusTrigger: e => {\n        handleDialogCancel(e);\n        e.stopPropagation();\n\n        _.invoke(triggerRef, 'current.focus');\n      },\n      close: e => handleDialogCancel(e),\n    },\n    mapPropsToBehavior: () => ({\n      headerId: headerId.current,\n      contentId: contentId.current,\n      trapFocus,\n      trigger,\n    }),\n    rtl: context.rtl,\n  });\n\n  const { classes, styles: resolvedStyles } = useStyles<DialogStylesProps>(Dialog.displayName, {\n    className: dialogClassName,\n    mapPropsToStyles: () => ({\n      backdrop,\n    }),\n    mapPropsToInlineStyles: () => ({\n      className,\n      design,\n      styles,\n      variables,\n    }),\n    rtl: context.rtl,\n  });\n\n  const [open, setOpen] = useAutoControlled({\n    defaultValue: props.defaultOpen,\n    value: props.open,\n    initialValue: false,\n  });\n\n  React.useEffect(() => {\n    const target = contentRef?.current;\n    if (open) {\n      disableBodyScroll(target);\n    }\n    return () => {\n      if (open) {\n        enableBodyScroll(target);\n      }\n    };\n  }, [open]);\n\n  const handleDialogCancel = (e: Event | React.SyntheticEvent) => {\n    _.invoke(props, 'onCancel', e, { ...props, open: false });\n    setOpen(false);\n  };\n\n  const handleDialogConfirm = (e: React.SyntheticEvent) => {\n    _.invoke(props, 'onConfirm', e, { ...props, open: false });\n    setOpen(false);\n  };\n\n  const handleDialogOpen = (e: React.SyntheticEvent) => {\n    _.invoke(props, 'onOpen', e, { ...props, open: true });\n    setOpen(true);\n  };\n\n  const handleCancelButtonOverrides = (predefinedProps: ButtonProps) => ({\n    onClick: (e: React.SyntheticEvent, buttonProps: ButtonProps) => {\n      _.invoke(predefinedProps, 'onClick', e, buttonProps);\n      handleDialogCancel(e);\n    },\n  });\n\n  const handleConfirmButtonOverrides = (predefinedProps: ButtonProps) => ({\n    onClick: (e: React.SyntheticEvent, buttonProps: ButtonProps) => {\n      _.invoke(predefinedProps, 'onClick', e, buttonProps);\n      handleDialogConfirm(e);\n    },\n  });\n\n  // when press left click on Dialog content and hold, and mouse up on Dialog overlay, Dialog should keep open\n  const isMouseDownInsideContent = React.useRef(false);\n  const registerMouseDownOnDialogContent = (e: React.MouseEvent) => {\n    if (e.button === 0) {\n      isMouseDownInsideContent.current = true;\n    }\n    if (unhandledProps.onMouseDown) {\n      _.invoke(unhandledProps, 'onMouseDown', e);\n    }\n  };\n\n  const handleOverlayClick = (e: MouseEvent) => {\n    // Dialog has different conditions to close than Popup, so we don't need to iterate across all\n    // refs\n    const isInsideContentClick =\n      isMouseDownInsideContent.current || doesNodeContainClick(contentRef.current, e, context.target);\n    isMouseDownInsideContent.current = false;\n\n    const isInsideOverlayClick = doesNodeContainClick(overlayRef.current, e, context.target);\n\n    const shouldClose = !isInsideContentClick && isInsideOverlayClick;\n\n    if (shouldClose) {\n      handleDialogCancel(e);\n    }\n  };\n\n  const handleDocumentKeydown = (getRefs: Function) => (e: KeyboardEvent) => {\n    // if focus was lost from Dialog, for e.g. when click on Dialog's content\n    // and ESC is pressed, the opened Dialog should get closed and the trigger should get focus\n    const lastOverlayRef = getRefs().pop();\n    const isLastOpenedDialog: boolean = lastOverlayRef && lastOverlayRef.current === overlayRef.current;\n    const targetIsBody = (e.target as HTMLElement).nodeName === 'BODY';\n\n    if (targetIsBody && getCode(e) === keyboardKey.Escape && isLastOpenedDialog) {\n      handleDialogCancel(e);\n      _.invoke(triggerRef, 'current.focus');\n    }\n  };\n\n  const cancelElement = createShorthand(Button, cancelButton, {\n    overrideProps: handleCancelButtonOverrides,\n  });\n\n  const confirmElement = createShorthand(Button, confirmButton, {\n    defaultProps: () => ({\n      primary: true,\n    }),\n    overrideProps: handleConfirmButtonOverrides,\n  });\n\n  const dialogActions =\n    (cancelElement || confirmElement) &&\n    ButtonGroup.create(actions, {\n      defaultProps: () => ({\n        styles: resolvedStyles.actions,\n      }),\n      overrideProps: {\n        content: (\n          <Flex gap=\"gap.smaller\" hAlign=\"end\">\n            {cancelElement}\n            {confirmElement}\n          </Flex>\n        ),\n      },\n    });\n\n  const dialogContent = (\n    <Ref innerRef={contentRef}>\n      <ElementType\n        {...getA11yProps('popup', {\n          className: classes.root,\n          ref,\n          ...unhandledProps,\n          onMouseDown: registerMouseDownOnDialogContent,\n        })}\n      >\n        {Header.create(header, {\n          defaultProps: () =>\n            getA11yProps('header', {\n              as: 'h2',\n              className: dialogSlotClassNames.header,\n              styles: resolvedStyles.header,\n            }),\n        })}\n        {createShorthand(Button, headerAction, {\n          defaultProps: () =>\n            getA11yProps('headerAction', {\n              className: dialogSlotClassNames.headerAction,\n              styles: resolvedStyles.headerAction,\n              text: true,\n              iconOnly: true,\n            }),\n        })}\n        {Box.create(content, {\n          defaultProps: () =>\n            getA11yProps('content', {\n              styles: resolvedStyles.content,\n              className: dialogSlotClassNames.content,\n            }),\n        })}\n        {DialogFooter.create(footer, {\n          overrideProps: {\n            content: dialogActions,\n            className: dialogSlotClassNames.footer,\n            styles: resolvedStyles.footer,\n          },\n        })}\n      </ElementType>\n    </Ref>\n  );\n\n  const triggerAccessibility: TriggerAccessibility = {\n    // refactor this when unstable_behaviorDefinition gets merged\n    attributes: accessibility(props).attributes.trigger,\n    keyHandlers: accessibility(props).keyActions.trigger,\n  };\n\n  const element = (\n    <Portal\n      onTriggerClick={handleDialogOpen}\n      open={open}\n      trapFocus={trapFocus}\n      trigger={trigger}\n      triggerAccessibility={triggerAccessibility}\n      triggerRef={triggerRef}\n    >\n      <Unstable_NestingAuto>\n        {(getRefs, nestingRef) => (\n          <>\n            <Ref\n              innerRef={(contentNode: HTMLElement) => {\n                overlayRef.current = contentNode;\n                nestingRef.current = contentNode;\n              }}\n            >\n              {Box.create(overlay, {\n                defaultProps: () => ({\n                  className: dialogSlotClassNames.overlay,\n                  styles: resolvedStyles.overlay,\n                }),\n                overrideProps: { content: dialogContent },\n              })}\n            </Ref>\n\n            {closeOnOutsideClick && (\n              <EventListener listener={handleOverlayClick} target={context.target} type=\"click\" capture />\n            )}\n            <EventListener listener={handleDocumentKeydown(getRefs)} target={context.target} type=\"keydown\" capture />\n          </>\n        )}\n      </Unstable_NestingAuto>\n    </Portal>\n  );\n  setEnd();\n  return element;\n}) as unknown as ForwardRefWithAs<'div', HTMLDivElement, DialogProps> &\n  FluentComponentStaticProps<DialogProps> & {\n    Footer: typeof DialogFooter;\n  };\n\nDialog.displayName = 'Dialog';\n\nDialog.propTypes = {\n  ...commonPropTypes.createCommon({\n    children: false,\n    content: 'shorthand',\n  }),\n  actions: customPropTypes.itemShorthand,\n  backdrop: PropTypes.bool,\n  headerAction: customPropTypes.itemShorthand,\n  cancelButton: customPropTypes.itemShorthand,\n  closeOnOutsideClick: PropTypes.bool,\n  confirmButton: customPropTypes.itemShorthand,\n  defaultOpen: PropTypes.bool,\n  header: customPropTypes.itemShorthand,\n  onCancel: PropTypes.func,\n  onConfirm: PropTypes.func,\n  onOpen: PropTypes.func,\n  open: PropTypes.bool,\n  overlay: customPropTypes.itemShorthand,\n  trapFocus: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n  trigger: PropTypes.any,\n};\n\nDialog.defaultProps = {\n  accessibility: dialogBehavior,\n  actions: {},\n  backdrop: true,\n  closeOnOutsideClick: true,\n  overlay: {},\n  footer: {},\n  trapFocus: true,\n};\n\nDialog.handledProps = Object.keys(Dialog.propTypes) as any;\n\nDialog.Footer = DialogFooter;\n\nDialog.create = createShorthandFactory({\n  Component: Dialog,\n});\n"],"mappings":"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"}