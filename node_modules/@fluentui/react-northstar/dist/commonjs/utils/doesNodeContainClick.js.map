{"version":3,"file":"doesNodeContainClick.js","names":["_domUtilities","require","doesNodeContainClick","node","e","target","allowVirtualParents","document","_some2","default","_isNil2","_invoke2","querySelector","elementContains","clientX","clientY","clientRects","getClientRects","offsetWidth","offsetHeight","length","_first2","_first3","top","bottom","left","right","_inRange2","exports"],"sources":["utils/doesNodeContainClick.tsx"],"sourcesContent":["import * as _ from 'lodash';\nimport { elementContains } from '@fluentui/dom-utilities';\n\n/**\n * Determines if a click's coordinates are within the bounds of a node.\n *\n * @see https://github.com/Semantic-Org/Semantic-UI-React/pull/2384\n *\n * @param node - A DOM node.\n * @param e - A SyntheticEvent or DOM Event.\n * @param target - A target document.\n * @param allowVirtualParents - A setting for `elementContains()`.\n */\nexport const doesNodeContainClick = (\n  node: HTMLElement,\n  e: MouseEvent,\n  // eslint-disable-next-line no-undef\n  target: Document = document,\n  allowVirtualParents: boolean = true,\n): boolean => {\n  if (_.some([e, node], _.isNil)) return false;\n\n  // if there is an e.target and it is in the document, use a simple node.contains() check\n  if (e.target) {\n    _.invoke(e.target, 'setAttribute', 'data-suir-click-target', true);\n\n    if (target.querySelector('[data-suir-click-target=true]')) {\n      _.invoke(e.target, 'removeAttribute', 'data-suir-click-target');\n      return elementContains(node, e.target as HTMLElement, allowVirtualParents);\n    }\n  }\n\n  // Below logic handles cases where the e.target is no longer in the document.\n  // The result of the click likely has removed the e.target node.\n  // Instead of node.contains(), we'll identify the click by X/Y position.\n\n  // return early if the event properties aren't available\n  // prevent measuring the node and repainting if we don't need to\n  const { clientX, clientY } = e;\n  if (_.some([clientX, clientY], _.isNil)) return false;\n\n  // false if the node is not visible\n  const clientRects = node.getClientRects();\n  // Heads Up!\n  // getClientRects returns a DOMRectList, not an array nor a plain object\n  // We explicitly avoid _.isEmpty and check .length to cover all possible shapes\n  if (!node.offsetWidth || !node.offsetHeight || !clientRects || !clientRects.length) return false;\n\n  // false if the node doesn't have a valid bounding rect\n  const { top, bottom, left, right } = _.first(clientRects);\n  if (_.some([top, bottom, left, right], _.isNil)) return false;\n\n  // we add a small decimal to the upper bound just to make it inclusive\n  // don't add an whole pixel (1) as the event/node values may be decimal sensitive\n  return _.inRange(clientY, top, bottom + 0.001) && _.inRange(clientX, left, right + 0.001);\n};\n"],"mappings":";;;;;;;;;;AACA,IAAAA,aAAA,GAAAC,OAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,IAAMC,oBAAoB,GAAG,SAAvBA,oBAAoBA,CAC/BC,IAAiB,EACjBC,CAAa;AACb;AACAC,MAAgB,EAChBC,mBAA4B,EAChB;EAAA,IAFZD,MAAgB;IAAhBA,MAAgB,GAAGE,QAAQ;EAAA;EAAA,IAC3BD,mBAA4B;IAA5BA,mBAA4B,GAAG,IAAI;EAAA;EAEnC,IAAI,IAAAE,MAAA,CAAAC,OAAA,EAAO,CAACL,CAAC,EAAED,IAAI,CAAC,EAAAO,OAAA,CAAAD,OAAS,CAAC,EAAE,OAAO,KAAK;;EAE5C;EACA,IAAIL,CAAC,CAACC,MAAM,EAAE;IACZ,IAAAM,QAAA,CAAAF,OAAA,EAASL,CAAC,CAACC,MAAM,EAAE,cAAc,EAAE,wBAAwB,EAAE,IAAI,CAAC;IAElE,IAAIA,MAAM,CAACO,aAAa,CAAC,+BAA+B,CAAC,EAAE;MACzD,IAAAD,QAAA,CAAAF,OAAA,EAASL,CAAC,CAACC,MAAM,EAAE,iBAAiB,EAAE,wBAAwB,CAAC;MAC/D,OAAO,IAAAQ,6BAAe,EAACV,IAAI,EAAEC,CAAC,CAACC,MAAM,EAAiBC,mBAAmB,CAAC;IAC5E;EACF;;EAEA;EACA;EACA;;EAEA;EACA;EACA,IAAQQ,OAAO,GAAcV,CAAC,CAAtBU,OAAO;IAAEC,OAAO,GAAKX,CAAC,CAAbW,OAAO;EACxB,IAAI,IAAAP,MAAA,CAAAC,OAAA,EAAO,CAACK,OAAO,EAAEC,OAAO,CAAC,EAAAL,OAAA,CAAAD,OAAS,CAAC,EAAE,OAAO,KAAK;;EAErD;EACA,IAAMO,WAAW,GAAGb,IAAI,CAACc,cAAc,CAAC,CAAC;EACzC;EACA;EACA;EACA,IAAI,CAACd,IAAI,CAACe,WAAW,IAAI,CAACf,IAAI,CAACgB,YAAY,IAAI,CAACH,WAAW,IAAI,CAACA,WAAW,CAACI,MAAM,EAAE,OAAO,KAAK;;EAEhG;EACA,IAAAC,OAAA,GAAqC,IAAAC,OAAA,CAAAb,OAAA,EAAQO,WAAW,CAAC;IAAjDO,GAAG,GAAAF,OAAA,CAAHE,GAAG;IAAEC,MAAM,GAAAH,OAAA,CAANG,MAAM;IAAEC,IAAI,GAAAJ,OAAA,CAAJI,IAAI;IAAEC,KAAK,GAAAL,OAAA,CAALK,KAAK;EAChC,IAAI,IAAAlB,MAAA,CAAAC,OAAA,EAAO,CAACc,GAAG,EAAEC,MAAM,EAAEC,IAAI,EAAEC,KAAK,CAAC,EAAAhB,OAAA,CAAAD,OAAS,CAAC,EAAE,OAAO,KAAK;;EAE7D;EACA;EACA,OAAO,IAAAkB,SAAA,CAAAlB,OAAA,EAAUM,OAAO,EAAEQ,GAAG,EAAEC,MAAM,GAAG,KAAK,CAAC,IAAI,IAAAG,SAAA,CAAAlB,OAAA,EAAUK,OAAO,EAAEW,IAAI,EAAEC,KAAK,GAAG,KAAK,CAAC;AAC3F,CAAC;AAACE,OAAA,CAAA1B,oBAAA,GAAAA,oBAAA"}