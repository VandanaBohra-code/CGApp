{"version":3,"file":"Popper.js","names":["useIsomorphicLayoutEffect","useMergedRefs","Ref","isRefObject","React","getPlacement","usePopper","Popper","props","usesRenderProps","children","proposedPlacement","align","position","rtl","latestPlacement","useRef","_React$useState","useState","computedPlacement","setComputedPlacement","popperRef","_usePopper","Object","assign","onStateUpdate","state","placement","current","targetRef","containerRef","arrowRef","_props$pointerTargetR","pointerTargetRef","scheduleUpdate","useCallback","_popperRef$current","updatePosition","child","createElement","innerRef","Children","only","defaultProps","enabled","modifiers","positionFixed","positioningDependencies"],"sources":["utils/positioner/Popper.tsx"],"sourcesContent":["import { useIsomorphicLayoutEffect, useMergedRefs } from '@fluentui/react-bindings';\nimport { Ref, isRefObject } from '@fluentui/react-component-ref';\nimport * as PopperJs from '@popperjs/core';\nimport * as React from 'react';\n\nimport { getPlacement } from './positioningHelper';\nimport { PopperChildrenFn, PopperProps, PopperRefHandle } from './types';\nimport { usePopper } from './usePopper';\n\n/**\n * Popper relies on the 3rd party library [Popper.js](https://github.com/FezVrasta/popper.js) for positioning.\n *\n * @deprecated Please use \"usePopper()\" hook instead.\n */\nexport const Popper: React.FunctionComponent<PopperProps> = props => {\n  const usesRenderProps: boolean = typeof props.children === 'function';\n\n  const proposedPlacement = getPlacement(props.align, props.position, props.rtl);\n  const latestPlacement = React.useRef<PopperJs.Placement>(proposedPlacement);\n  const [computedPlacement, setComputedPlacement] = React.useState<PopperJs.Placement>(proposedPlacement);\n\n  const popperRef = React.useRef<PopperRefHandle | null>(null);\n  const { targetRef, containerRef, arrowRef } = usePopper({\n    ...props,\n\n    popperRef: useMergedRefs(props.popperRef, popperRef),\n    onStateUpdate: state => {\n      // PopperJS performs computations that might update the computed placement: auto positioning, flipping the\n      // placement in case the popper box should be rendered at the edge of the viewport and does not fit\n      if (state.placement !== latestPlacement.current) {\n        latestPlacement.current = state.placement;\n\n        // A state change has sense only if renderProps are passed, otherwise a state value is unused\n        if (usesRenderProps) {\n          setComputedPlacement(state.placement);\n        }\n      }\n    },\n  });\n\n  useIsomorphicLayoutEffect(() => {\n    // A way to sync refs, is needed as Popper component accepts refs as params\n    // Does not make anything worse as Popper component does not have proper handing for ref updates ¯\\_(ツ)_/¯\n    targetRef.current = isRefObject(props.targetRef)\n      ? (props.targetRef as React.RefObject<Element>).current\n      : (props.targetRef as PopperJs.VirtualElement);\n    arrowRef.current = props.pointerTargetRef?.current as HTMLElement;\n  });\n\n  const scheduleUpdate = React.useCallback(() => {\n    popperRef.current?.updatePosition();\n  }, []);\n\n  const child = usesRenderProps\n    ? (props.children as PopperChildrenFn)({\n        placement: computedPlacement,\n        scheduleUpdate,\n      })\n    : (props.children as React.ReactElement);\n\n  return child ? <Ref innerRef={containerRef}>{React.Children.only(child)}</Ref> : null;\n};\n\nPopper.defaultProps = {\n  enabled: true,\n  modifiers: [],\n  positionFixed: false,\n  positioningDependencies: [],\n};\n"],"mappings":"AAAA,SAASA,yBAAyB,EAAEC,aAAa,QAAQ,0BAA0B;AACnF,SAASC,GAAG,EAAEC,WAAW,QAAQ,+BAA+B;AAEhE,OAAO,KAAKC,KAAK,MAAM,OAAO;AAE9B,SAASC,YAAY,QAAQ,qBAAqB;AAElD,SAASC,SAAS,QAAQ,aAAa;;AAEvC;AACA;AACA;AACA;AACA;AACA,OAAO,IAAMC,MAA4C;EAAA,IAA5CA,MAA4C,GAAG,SAA/CA,MAA4CA,CAAGC,KAAK,EAAI;IACnE,IAAMC,eAAwB,GAAG,OAAOD,KAAK,CAACE,QAAQ,KAAK,UAAU;IAErE,IAAMC,iBAAiB,GAAGN,YAAY,CAACG,KAAK,CAACI,KAAK,EAAEJ,KAAK,CAACK,QAAQ,EAAEL,KAAK,CAACM,GAAG,CAAC;IAC9E,IAAMC,eAAe,GAAGX,KAAK,CAACY,MAAM,CAAqBL,iBAAiB,CAAC;IAC3E,IAAAM,eAAA,GAAkDb,KAAK,CAACc,QAAQ,CAAqBP,iBAAiB,CAAC;MAAhGQ,iBAAiB,GAAAF,eAAA;MAAEG,oBAAoB,GAAAH,eAAA;IAE9C,IAAMI,SAAS,GAAGjB,KAAK,CAACY,MAAM,CAAyB,IAAI,CAAC;IAC5D,IAAAM,UAAA,GAA8ChB,SAAS,CAAAiB,MAAA,CAAAC,MAAA,KAClDhB,KAAK;QAERa,SAAS,EAAEpB,aAAa,CAACO,KAAK,CAACa,SAAS,EAAEA,SAAS,CAAC;QACpDI,aAAa,EAAE,SAAAA,cAAAC,KAAK,EAAI;UACtB;UACA;UACA,IAAIA,KAAK,CAACC,SAAS,KAAKZ,eAAe,CAACa,OAAO,EAAE;YAC/Cb,eAAe,CAACa,OAAO,GAAGF,KAAK,CAACC,SAAS;;YAEzC;YACA,IAAIlB,eAAe,EAAE;cACnBW,oBAAoB,CAACM,KAAK,CAACC,SAAS,CAAC;YACvC;UACF;QACF;MAAC,EACF,CAAC;MAhBME,SAAS,GAAAP,UAAA,CAATO,SAAS;MAAEC,YAAY,GAAAR,UAAA,CAAZQ,YAAY;MAAEC,QAAQ,GAAAT,UAAA,CAARS,QAAQ;IAkBzC/B,yBAAyB,CAAC,YAAM;MAAA,IAAAgC,qBAAA;MAC9B;MACA;MACAH,SAAS,CAACD,OAAO,GAAGzB,WAAW,CAACK,KAAK,CAACqB,SAAS,CAAC,GAC3CrB,KAAK,CAACqB,SAAS,CAA8BD,OAAO,GACpDpB,KAAK,CAACqB,SAAqC;MAChDE,QAAQ,CAACH,OAAO,IAAAI,qBAAA,GAAGxB,KAAK,CAACyB,gBAAgB,qBAAtBD,qBAAA,CAAwBJ,OAAsB;IACnE,CAAC,CAAC;IAEF,IAAMM,cAAc,GAAG9B,KAAK,CAAC+B,WAAW,CAAC,YAAM;MAAA,IAAAC,kBAAA;MAC7C,CAAAA,kBAAA,GAAAf,SAAS,CAACO,OAAO,qBAAjBQ,kBAAA,CAAmBC,cAAc,CAAC,CAAC;IACrC,CAAC,EAAE,EAAE,CAAC;IAEN,IAAMC,KAAK,GAAG7B,eAAe,GACxBD,KAAK,CAACE,QAAQ,CAAsB;MACnCiB,SAAS,EAAER,iBAAiB;MAC5Be,cAAc,EAAdA;IACF,CAAC,CAAC,GACD1B,KAAK,CAACE,QAA+B;IAE1C,OAAO4B,KAAK,gBAAGlC,KAAA,CAAAmC,aAAA,CAACrC,GAAG;MAACsC,QAAQ,EAAEV;IAAa,GAAE1B,KAAK,CAACqC,QAAQ,CAACC,IAAI,CAACJ,KAAK,CAAO,CAAC,GAAG,IAAI;EACvF,CAAC;EAED/B,MAAM,CAACoC,YAAY,GAAG;IACpBC,OAAO,EAAE,IAAI;IACbC,SAAS,EAAE,EAAE;IACbC,aAAa,EAAE,KAAK;IACpBC,uBAAuB,EAAE;EAC3B,CAAC;EAAC,OAtDWxC,MAA4C;AAAA"}