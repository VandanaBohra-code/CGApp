{"version":3,"file":"ToolbarItem.js","names":["toolbarItemBehavior","compose","getElementType","mergeVariablesOverrides","useUnhandledProps","useFluentContext","useAccessibility","useStyles","useTelemetry","useContextSelectors","handleRef","Ref","EventListener","Unstable_NestingAuto","customPropTypes","PropTypes","React","createShorthand","doesNodeContainClick","commonPropTypes","childrenExist","partitionPopperPropsFromShorthand","Popper","ToolbarMenu","Popup","ToolbarVariablesContext","ToolbarVariablesProvider","ToolbarItemWrapper","ToolbarItemIcon","ToolbarMenuContext","toolbarItemClassName","ToolbarItem","props","ref","composeOptions","context","_useTelemetry","displayName","telemetry","setStart","setEnd","accessibility","active","className","design","icon","children","disabled","disabledFocusable","popup","menuOpen","wrapper","styles","variables","_partitionPopperProps","menu","positioningProps","itemRef","useRef","menuRef","parentVariables","useContext","mergedVariables","_ref","menuSlot","v","slots","getA11yProps","debugName","actionHandlers","performClick","event","preventDefault","handleClick","performWrapperClick","handleWrapperClick","closeMenuAndFocusTrigger","trySetMenuOpen","_invoke","current","doNotNavigateNextToolbarItem","stopPropagation","mapPropsToBehavior","as","String","hasMenu","hasPopup","rtl","_useStyles","mapPropsToStyles","mapPropsToInlineStyles","unstable_props","classes","handleBlur","e","handleFocus","nativeEvent","target","handleOutsideClick","getRefs","isItemClick","isNestedClick","_some","childRef","isInside","newValue","Object","assign","handleMenuOverrides","predefinedProps","onBlur","isInsideOrMenuTrigger","contains","relatedTarget","onItemClick","itemProps","ElementType","slotProps","resolveSlotProps","unhandledProps","handledProps","itemElement","createElement","innerRef","node","root","onFocus","onClick","submenuElement","nestingRef","Fragment","_extends","align","position","targetRef","value","defaultProps","overrideProps","listener","type","capture","popupElement","trigger","undefined","contentElement","wrapperElement","trapFocus","shorthandConfig","mappedProp","propTypes","createCommon","bool","shorthandAllowingChildren","oneOfType","arrayOf","onMenuOpenChange","func","shape","never","string"],"sources":["components/Toolbar/ToolbarItem.tsx"],"sourcesContent":["import { Accessibility, toolbarItemBehavior, ToolbarItemBehaviorProps } from '@fluentui/accessibility';\nimport {\n  compose,\n  getElementType,\n  mergeVariablesOverrides,\n  useUnhandledProps,\n  useFluentContext,\n  useAccessibility,\n  useStyles,\n  useTelemetry,\n  useContextSelectors,\n} from '@fluentui/react-bindings';\nimport { handleRef, Ref } from '@fluentui/react-component-ref';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { GetRefs, NodeRef, Unstable_NestingAuto } from '@fluentui/react-component-nesting-registry';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport {\n  createShorthand,\n  doesNodeContainClick,\n  UIComponentProps,\n  ChildrenComponentProps,\n  ContentComponentProps,\n  commonPropTypes,\n  childrenExist,\n} from '../../utils';\nimport { ComponentEventHandler, ShorthandValue, ShorthandCollection } from '../../types';\nimport { partitionPopperPropsFromShorthand, Popper, PopperShorthandProps } from '../../utils/positioner';\n\nimport { ToolbarMenu, ToolbarMenuProps } from './ToolbarMenu';\nimport { Popup, PopupProps } from '../Popup/Popup';\nimport { ToolbarMenuItemProps } from '../Toolbar/ToolbarMenuItem';\nimport { ToolbarItemShorthandKinds } from './Toolbar';\nimport { ToolbarVariablesContext, ToolbarVariablesProvider } from './toolbarVariablesContext';\nimport { ToolbarItemWrapper, ToolbarItemWrapperProps } from './ToolbarItemWrapper';\nimport { ToolbarItemIcon, ToolbarItemIconProps } from './ToolbarItemIcon';\nimport { ToolbarItemSubscribedValue, ToolbarMenuContext } from './toolbarMenuContext';\n\nexport interface ToolbarItemProps extends UIComponentProps, ChildrenComponentProps, ContentComponentProps {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<ToolbarItemBehaviorProps>;\n\n  /** A toolbar item can be active. */\n  active?: boolean;\n\n  /** A toolbar item can show it is currently unable to be interacted with. */\n  disabled?: boolean;\n\n  /** A toolbar item can be disabled and focusable at the same time. */\n  disabledFocusable?: boolean;\n\n  /** Name or shorthand for Toolbar Item Icon */\n  icon?: ShorthandValue<ToolbarItemIconProps>;\n\n  /**\n   * Shorthand for the submenu.\n   * If submenu is specified, the item is wrapped to group the item and the menu elements together.\n   */\n  menu?:\n    | ShorthandValue<ToolbarMenuProps & { popper?: PopperShorthandProps }>\n    | ShorthandCollection<ToolbarMenuItemProps, ToolbarItemShorthandKinds>;\n\n  /** Indicates if the menu inside the item is open. */\n  menuOpen?: boolean;\n\n  /**\n   * Event for request to change 'menuOpen' value.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props and proposed value.\n   */\n  onMenuOpenChange?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called on click.\n   *\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onClick?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called after user's focus.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onFocus?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Called after item blur.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props.\n   */\n  onBlur?: ComponentEventHandler<ToolbarItemProps>;\n\n  /**\n   * Attaches a `Popup` component to the ToolbarItem.\n   * Accepts all props as a `Popup`, except `trigger` and `children`.\n   * Traps focus by default.\n   * @see PopupProps\n   */\n  popup?: Omit<PopupProps, 'trigger' | 'children'> | string;\n\n  /** Shorthand for the wrapper component. The item is wrapped only if it contains a menu! */\n  wrapper?: ShorthandValue<ToolbarItemWrapperProps>;\n}\n\nexport type ToolbarItemStylesProps = Required<Pick<ToolbarItemProps, 'active' | 'disabled' | 'disabledFocusable'>>;\n\nexport const toolbarItemClassName = 'ui-toolbar__item';\n\n/**\n * A ToolbarItem renders Toolbar item as a button with an icon.\n */\nexport const ToolbarItem = compose<'button', ToolbarItemProps, ToolbarItemStylesProps, {}, {}>(\n  (props, ref, composeOptions) => {\n    const context = useFluentContext();\n    const { setStart, setEnd } = useTelemetry(composeOptions.displayName, context.telemetry);\n    setStart();\n\n    const {\n      accessibility,\n      active,\n      className,\n      design,\n      icon,\n      children,\n      disabled,\n      disabledFocusable,\n      popup,\n      menuOpen,\n      wrapper,\n      styles,\n      variables,\n    } = props;\n    const [menu, positioningProps] = partitionPopperPropsFromShorthand(props.menu);\n\n    const itemRef = React.useRef<HTMLElement>();\n    const menuRef = React.useRef<HTMLElement>();\n\n    const parentVariables = React.useContext(ToolbarVariablesContext);\n    const mergedVariables = mergeVariablesOverrides(parentVariables, variables);\n\n    const { menuSlot } = useContextSelectors(ToolbarMenuContext, {\n      menuSlot: v => v.slots.menu,\n    }) as unknown as ToolbarItemSubscribedValue; // TODO: we should improve typings for the useContextSelectors\n\n    const getA11yProps = useAccessibility(accessibility, {\n      debugName: composeOptions.displayName,\n      actionHandlers: {\n        performClick: event => {\n          event.preventDefault();\n          handleClick(event);\n        },\n        performWrapperClick: event => {\n          handleWrapperClick(event);\n        },\n        closeMenuAndFocusTrigger: event => {\n          trySetMenuOpen(false, event);\n          _.invoke(itemRef.current, 'focus');\n        },\n        doNotNavigateNextToolbarItem: event => {\n          event.stopPropagation();\n        },\n      },\n      mapPropsToBehavior: () => ({\n        as: String(props.as),\n        disabled,\n        disabledFocusable,\n        hasMenu: !!menu,\n        hasPopup: !!popup,\n        menuOpen,\n        active,\n      }),\n      rtl: context.rtl,\n    });\n    const { classes } = useStyles<ToolbarItemStylesProps>(composeOptions.displayName, {\n      className: composeOptions.className,\n      composeOptions,\n      mapPropsToStyles: () => ({ active, disabled, disabledFocusable }),\n      mapPropsToInlineStyles: () => ({\n        className,\n        design,\n        styles,\n        variables: mergedVariables,\n      }),\n      rtl: context.rtl,\n      unstable_props: props,\n    });\n\n    const handleBlur = (e: React.SyntheticEvent) => {\n      _.invoke(props, 'onBlur', e, props);\n    };\n\n    const handleFocus = (e: React.SyntheticEvent) => {\n      _.invoke(props, 'onFocus', e, props);\n    };\n\n    const handleClick = (e: React.MouseEvent | React.KeyboardEvent) => {\n      if (disabled || disabledFocusable) {\n        e.preventDefault();\n        return;\n      }\n\n      if (menu) {\n        trySetMenuOpen(!menuOpen, e);\n      }\n\n      _.invoke(props, 'onClick', e, props);\n    };\n\n    const handleWrapperClick = (e: React.MouseEvent | React.KeyboardEvent) => {\n      if (menu) {\n        if (doesNodeContainClick(menuRef.current, e.nativeEvent as MouseEvent, context.target, false)) {\n          trySetMenuOpen(false, e);\n        }\n      }\n    };\n\n    const handleOutsideClick = (getRefs: GetRefs) => (e: MouseEvent) => {\n      const isItemClick = doesNodeContainClick(itemRef.current, e, context.target);\n      const isNestedClick = _.some(getRefs(), (childRef: NodeRef) => {\n        return doesNodeContainClick(childRef.current as HTMLElement, e, context.target);\n      });\n      const isInside = isItemClick || isNestedClick;\n\n      if (!isInside) {\n        trySetMenuOpen(false, e);\n      }\n    };\n\n    const trySetMenuOpen = (newValue: boolean, e: Event | React.SyntheticEvent) => {\n      _.invoke(props, 'onMenuOpenChange', e, { ...props, menuOpen: newValue });\n    };\n\n    const handleMenuOverrides = (getRefs: GetRefs) => (predefinedProps: ToolbarMenuProps) => ({\n      onBlur: (e: React.FocusEvent) => {\n        const isInsideOrMenuTrigger = _.some(getRefs(), (childRef: NodeRef) => {\n          return (\n            childRef.current.contains(e.relatedTarget as HTMLElement) ||\n            itemRef.current.contains(e.relatedTarget as HTMLElement)\n          );\n        });\n\n        if (!isInsideOrMenuTrigger) {\n          trySetMenuOpen(false, e);\n        }\n      },\n      onItemClick: (e, itemProps: ToolbarMenuItemProps) => {\n        const { popup, menuOpen } = itemProps;\n        _.invoke(predefinedProps, 'onItemClick', e, itemProps);\n        if (popup) {\n          return;\n        }\n        // TODO: should we pass toolbarMenuItem to the user callback so he can decide if he wants to close the menu?\n        trySetMenuOpen(menuOpen, e);\n      },\n    });\n\n    const ElementType = getElementType(props);\n    const slotProps = composeOptions.resolveSlotProps<ToolbarItemProps>(props);\n    const unhandledProps = useUnhandledProps(composeOptions.handledProps, props);\n\n    const itemElement = (\n      <Ref\n        innerRef={node => {\n          itemRef.current = node;\n          handleRef(ref, node);\n        }}\n      >\n        <ElementType\n          {...getA11yProps('root', {\n            ...unhandledProps,\n            disabled,\n            className: classes.root,\n            onBlur: handleBlur,\n            onFocus: handleFocus,\n            onClick: handleClick,\n          })}\n        >\n          {childrenExist(children) ? children : createShorthand(composeOptions.slots.icon, icon, slotProps.icon)}\n        </ElementType>\n      </Ref>\n    );\n\n    const submenuElement = menuOpen ? (\n      <Unstable_NestingAuto>\n        {(getRefs, nestingRef) => {\n          return (\n            <>\n              <Ref\n                innerRef={(node: HTMLElement) => {\n                  nestingRef.current = node;\n                  menuRef.current = node;\n                }}\n              >\n                <Popper align=\"start\" position=\"above\" targetRef={itemRef} {...positioningProps}>\n                  <ToolbarVariablesProvider value={mergedVariables}>\n                    {createShorthand(composeOptions.slots.menu || menuSlot || ToolbarMenu, menu, {\n                      defaultProps: () => slotProps.menu,\n                      overrideProps: handleMenuOverrides(getRefs),\n                    })}\n                  </ToolbarVariablesProvider>\n                </Popper>\n              </Ref>\n              <EventListener listener={handleOutsideClick(getRefs)} target={context.target} type=\"click\" capture />\n            </>\n          );\n        }}\n      </Unstable_NestingAuto>\n    ) : null;\n\n    if (popup) {\n      const popupElement = createShorthand(composeOptions.slots.popup, popup, {\n        defaultProps: () => slotProps.popup,\n        overrideProps: {\n          trigger: itemElement,\n          children: undefined, // force-reset `children` defined for `Popup` as it collides with the `trigger`\n        },\n      });\n      setEnd();\n\n      return popupElement;\n    }\n\n    // wrap the item if it has menu (even if it is closed = not rendered)\n    if (menu) {\n      const contentElement = (\n        <>\n          {itemElement}\n          {submenuElement}\n        </>\n      );\n\n      if (wrapper) {\n        const wrapperElement = createShorthand(composeOptions.slots.wrapper, wrapper, {\n          defaultProps: () => getA11yProps('wrapper', slotProps.wrapper || {}),\n          overrideProps: predefinedProps => ({\n            children: contentElement,\n            onClick: e => {\n              handleWrapperClick(e);\n              _.invoke(predefinedProps, 'onClick', e);\n            },\n          }),\n        });\n        setEnd();\n\n        return wrapperElement;\n      }\n\n      setEnd();\n      return contentElement;\n    }\n\n    setEnd();\n\n    return itemElement;\n  },\n  {\n    className: toolbarItemClassName,\n    displayName: 'ToolbarItem',\n\n    slots: {\n      icon: ToolbarItemIcon,\n      wrapper: ToolbarItemWrapper,\n      popup: Popup, // TODO: compose Popup to ToolbarItemPopup once it has compose functionality\n    },\n\n    slotProps: () => ({\n      popup: { trapFocus: true },\n    }),\n\n    shorthandConfig: { mappedProp: 'content' },\n    handledProps: [\n      'accessibility',\n      'as',\n      'children',\n      'className',\n      'content',\n      'design',\n      'styles',\n      'disabledFocusable',\n      'variables',\n      'active',\n      'disabled',\n      'icon',\n      'menu',\n      'menuOpen',\n      'onMenuOpenChange',\n      'onClick',\n      'onFocus',\n      'onBlur',\n      'popup',\n      'wrapper',\n    ],\n  },\n);\n\nToolbarItem.propTypes = {\n  ...commonPropTypes.createCommon(),\n  active: PropTypes.bool,\n  disabled: PropTypes.bool,\n  disabledFocusable: PropTypes.bool,\n  icon: customPropTypes.shorthandAllowingChildren,\n  menu: PropTypes.oneOfType([\n    customPropTypes.shorthandAllowingChildren,\n    PropTypes.arrayOf(customPropTypes.shorthandAllowingChildren),\n  ]),\n  menuOpen: PropTypes.bool,\n  onMenuOpenChange: PropTypes.func,\n  onClick: PropTypes.func,\n  onFocus: PropTypes.func,\n  onBlur: PropTypes.func,\n  popup: PropTypes.oneOfType([\n    PropTypes.shape({\n      ...Popup.propTypes,\n      trigger: customPropTypes.never,\n      children: customPropTypes.never,\n    }),\n    PropTypes.string,\n  ]),\n  wrapper: customPropTypes.shorthandAllowingChildren,\n};\nToolbarItem.defaultProps = {\n  as: 'button',\n  accessibility: toolbarItemBehavior,\n  wrapper: {},\n};\n"],"mappings":"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"}