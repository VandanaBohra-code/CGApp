{"version":3,"file":"formFieldBase.js","names":["formFieldBehavior","customPropTypes","PropTypes","React","commonPropTypes","getOrGenerateIdFromShorthand","createShorthand","Box","getElementType","useUnhandledProps","useTelemetry","useAccessibility","useFluentContext","compose","useStyles","FormLabel","FormMessage","FormFieldBaseProvider","formFieldBaseClassName","_FormFieldBase","props","ref","composeOptions","context","_useTelemetry","displayName","telemetry","setStart","setEnd","message","inline","errorMessage","control","label","className","design","styles","variables","slotProps","resolveSlotProps","ElementType","unhandledProps","handledProps","messageId","useRef","current","labelId","_useStyles","mapPropsToInlineStyles","rtl","unstable_props","classes","getA11yProps","accessibility","debugName","mapPropsToBehavior","hasErrorMessage","childProps","useMemo","element","createElement","root","slots","defaultProps","Object","assign","id","value","error","shorthandConfig","mappedProp","propTypes","createCommon","children","bool","itemShorthand"],"sources":["components/Form/utils/formFieldBase.tsx"],"sourcesContent":["import { Accessibility, FormFieldBehaviorProps, formFieldBehavior } from '@fluentui/accessibility';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport { UIComponentProps, commonPropTypes, getOrGenerateIdFromShorthand, createShorthand } from '../../../utils';\nimport { ShorthandValue } from '../../../types';\nimport { Box, BoxProps } from '../../Box/Box';\nimport {\n  getElementType,\n  useUnhandledProps,\n  useTelemetry,\n  useAccessibility,\n  useFluentContext,\n  compose,\n  useStyles,\n} from '@fluentui/react-bindings';\nimport { FormLabel, FormLabelProps } from '../FormLabel';\nimport { FormMessage, FormMessageProps } from '../FormMessage';\nimport { FormFieldBaseValue, FormFieldBaseProvider } from './formFieldBaseContext';\n\nexport interface FormFieldBaseProps extends UIComponentProps {\n  /**\n   * Accessibility behavior if overridden by the user.\n   */\n  accessibility?: Accessibility<FormFieldBehaviorProps>;\n\n  /** A field can have its label next to instead of above it. */\n  inline?: boolean;\n\n  /** A control for the form field. */\n  control?: ShorthandValue<BoxProps>;\n\n  /** A label for the form field. */\n  label?: ShorthandValue<FormLabelProps>;\n\n  /** Text message that will be displayed below the control (can be used for error, warning, success messages). */\n  message?: ShorthandValue<FormMessageProps>;\n\n  /** Message to be shown when input has error */\n  errorMessage?: ShorthandValue<FormMessageProps>;\n}\n\nexport const formFieldBaseClassName = 'ui-form__field__base';\nexport type FormFieldBaseStylesProps = never;\n\n/**\n * A FormFiedBase represents a Form element containing a label and an input.\n */\nexport const _FormFieldBase = compose<'div', FormFieldBaseProps, {}, {}, {}>(\n  (props, ref, composeOptions) => {\n    const context = useFluentContext();\n    const { setStart, setEnd } = useTelemetry(composeOptions.displayName, context.telemetry);\n    setStart();\n\n    const { message, inline, errorMessage, control, label, className, design, styles, variables } = props;\n\n    const slotProps = composeOptions.resolveSlotProps<FormFieldBaseProps>(props);\n    const ElementType = getElementType(props);\n    const unhandledProps = useUnhandledProps(composeOptions.handledProps, props);\n    const messageId = React.useRef<string>();\n    messageId.current = getOrGenerateIdFromShorthand('error-message-', errorMessage || message, messageId.current);\n    const labelId = React.useRef<string>();\n    labelId.current = getOrGenerateIdFromShorthand('form-label-', label, labelId.current);\n\n    const { classes } = useStyles<FormFieldBaseStylesProps>(_FormFieldBase.displayName, {\n      className: composeOptions.className,\n      composeOptions,\n      mapPropsToInlineStyles: () => ({\n        className,\n        design,\n        styles,\n        variables,\n      }),\n      rtl: context.rtl,\n      unstable_props: props,\n    });\n\n    const getA11yProps = useAccessibility<FormFieldBehaviorProps>(props.accessibility, {\n      debugName: composeOptions.displayName,\n      mapPropsToBehavior: () => ({\n        hasErrorMessage: !!errorMessage,\n        messageId: messageId.current,\n        labelId: labelId.current,\n      }),\n      rtl: context.rtl,\n    });\n\n    const childProps: FormFieldBaseValue = React.useMemo(\n      () => ({\n        labelId: labelId.current,\n      }),\n      // TODO: create hooks for id to avoid disbaling esling for accessing the value of refs\n      // eslint-disable-next-line\n      [labelId.current],\n    );\n\n    const element = (\n      <ElementType\n        {...getA11yProps('root', {\n          className: classes.root,\n        })}\n      >\n        {createShorthand(composeOptions.slots.label, label, {\n          defaultProps: () =>\n            getA11yProps('label', {\n              id: labelId.current,\n              inline,\n              ...slotProps.label,\n            }),\n        })}\n        {/**\n         * When there's a message for the input the labelId and messageId should be consistent in the\n         * aria-labelledby attribute (aria-labelledby=\"labelID messageID\") therefore we need to pass it down\n         * for components like input that are generating its own label internally\n         */}\n        <FormFieldBaseProvider value={childProps}>\n          {createShorthand(composeOptions.slots.control, control || {}, {\n            defaultProps: () =>\n              getA11yProps('control', {\n                error: !!errorMessage || null,\n                ref,\n                ...unhandledProps,\n                ...slotProps.control,\n              }),\n          })}\n        </FormFieldBaseProvider>\n        {createShorthand(composeOptions.slots.message, errorMessage || message, {\n          defaultProps: () =>\n            getA11yProps('message', {\n              id: messageId.current,\n              ...slotProps.message,\n            }),\n        })}\n      </ElementType>\n    );\n    setEnd();\n    return element;\n  },\n  {\n    className: formFieldBaseClassName,\n    displayName: 'FormFieldBase',\n    slots: {\n      label: FormLabel,\n      message: FormMessage,\n      control: Box,\n    },\n    handledProps: [\n      'as',\n      'accessibility',\n      'className',\n      'variables',\n      'design',\n      'styles',\n      'inline',\n      'errorMessage',\n      'message',\n    ],\n    shorthandConfig: {\n      mappedProp: 'control',\n    },\n  },\n);\n\n_FormFieldBase.propTypes = {\n  ...commonPropTypes.createCommon({ children: false }),\n  inline: PropTypes.bool,\n  message: customPropTypes.itemShorthand,\n  errorMessage: customPropTypes.itemShorthand,\n};\n\n_FormFieldBase.defaultProps = {\n  accessibility: formFieldBehavior,\n};\n"],"mappings":"AAAA,SAAgDA,iBAAiB,QAAQ,yBAAyB;AAClG,OAAO,KAAKC,eAAe,MAAM,2BAA2B;AAC5D,OAAO,KAAKC,SAAS,MAAM,YAAY;AACvC,OAAO,KAAKC,KAAK,MAAM,OAAO;AAC9B,SAA2BC,eAAe,EAAEC,4BAA4B,EAAEC,eAAe,QAAQ,gBAAgB;AAEjH,SAASC,GAAG,QAAkB,eAAe;AAC7C,SACEC,cAAc,EACdC,iBAAiB,EACjBC,YAAY,EACZC,gBAAgB,EAChBC,gBAAgB,EAChBC,OAAO,EACPC,SAAS,QACJ,0BAA0B;AACjC,SAASC,SAAS,QAAwB,cAAc;AACxD,SAASC,WAAW,QAA0B,gBAAgB;AAC9D,SAA6BC,qBAAqB,QAAQ,wBAAwB;AAwBlF,OAAO,IAAMC,sBAAsB,GAAG,sBAAsB;AAG5D;AACA;AACA;AACA,OAAO,IAAMC,cAAc;EAAA,IAAdA,cAAc,GAAGN,OAAO,CACnC,UAACO,KAAK,EAAEC,GAAG,EAAEC,cAAc,EAAK;IAC9B,IAAMC,OAAO,GAAGX,gBAAgB,CAAC,CAAC;IAClC,IAAAY,aAAA,GAA6Bd,YAAY,CAACY,cAAc,CAACG,WAAW,EAAEF,OAAO,CAACG,SAAS,CAAC;MAAhFC,QAAQ,GAAAH,aAAA,CAARG,QAAQ;MAAEC,MAAM,GAAAJ,aAAA,CAANI,MAAM;IACxBD,QAAQ,CAAC,CAAC;IAEV,IAAQE,OAAO,GAAiFT,KAAK,CAA7FS,OAAO;MAAEC,MAAM,GAAyEV,KAAK,CAApFU,MAAM;MAAEC,YAAY,GAA2DX,KAAK,CAA5EW,YAAY;MAAEC,OAAO,GAAkDZ,KAAK,CAA9DY,OAAO;MAAEC,KAAK,GAA2Cb,KAAK,CAArDa,KAAK;MAAEC,SAAS,GAAgCd,KAAK,CAA9Cc,SAAS;MAAEC,MAAM,GAAwBf,KAAK,CAAnCe,MAAM;MAAEC,MAAM,GAAgBhB,KAAK,CAA3BgB,MAAM;MAAEC,SAAS,GAAKjB,KAAK,CAAnBiB,SAAS;IAE3F,IAAMC,SAAS,GAAGhB,cAAc,CAACiB,gBAAgB,CAAqBnB,KAAK,CAAC;IAC5E,IAAMoB,WAAW,GAAGhC,cAAc,CAACY,KAAK,CAAC;IACzC,IAAMqB,cAAc,GAAGhC,iBAAiB,CAACa,cAAc,CAACoB,YAAY,EAAEtB,KAAK,CAAC;IAC5E,IAAMuB,SAAS,GAAGxC,KAAK,CAACyC,MAAM,CAAS,CAAC;IACxCD,SAAS,CAACE,OAAO,GAAGxC,4BAA4B,CAAC,gBAAgB,EAAE0B,YAAY,IAAIF,OAAO,EAAEc,SAAS,CAACE,OAAO,CAAC;IAC9G,IAAMC,OAAO,GAAG3C,KAAK,CAACyC,MAAM,CAAS,CAAC;IACtCE,OAAO,CAACD,OAAO,GAAGxC,4BAA4B,CAAC,aAAa,EAAE4B,KAAK,EAAEa,OAAO,CAACD,OAAO,CAAC;IAErF,IAAAE,UAAA,GAAoBjC,SAAS,CAA2BK,cAAc,CAACM,WAAW,EAAE;QAClFS,SAAS,EAAEZ,cAAc,CAACY,SAAS;QACnCZ,cAAc,EAAdA,cAAc;QACd0B,sBAAsB,EAAE,SAAAA,uBAAA;UAAA,OAAO;YAC7Bd,SAAS,EAATA,SAAS;YACTC,MAAM,EAANA,MAAM;YACNC,MAAM,EAANA,MAAM;YACNC,SAAS,EAATA;UACF,CAAC;QAAA,CAAC;QACFY,GAAG,EAAE1B,OAAO,CAAC0B,GAAG;QAChBC,cAAc,EAAE9B;MAClB,CAAC,CAAC;MAXM+B,OAAO,GAAAJ,UAAA,CAAPI,OAAO;IAaf,IAAMC,YAAY,GAAGzC,gBAAgB,CAAyBS,KAAK,CAACiC,aAAa,EAAE;MACjFC,SAAS,EAAEhC,cAAc,CAACG,WAAW;MACrC8B,kBAAkB,EAAE,SAAAA,mBAAA;QAAA,OAAO;UACzBC,eAAe,EAAE,CAAC,CAACzB,YAAY;UAC/BY,SAAS,EAAEA,SAAS,CAACE,OAAO;UAC5BC,OAAO,EAAEA,OAAO,CAACD;QACnB,CAAC;MAAA,CAAC;MACFI,GAAG,EAAE1B,OAAO,CAAC0B;IACf,CAAC,CAAC;IAEF,IAAMQ,UAA8B,GAAGtD,KAAK,CAACuD,OAAO,CAClD;MAAA,OAAO;QACLZ,OAAO,EAAEA,OAAO,CAACD;MACnB,CAAC;IAAA,CAAC;IACF;IACA;IACA,CAACC,OAAO,CAACD,OAAO,CAClB,CAAC;IAED,IAAMc,OAAO,gBACXxD,KAAA,CAAAyD,aAAA,CAACpB,WAAW,EACNY,YAAY,CAAC,MAAM,EAAE;MACvBlB,SAAS,EAAEiB,OAAO,CAACU;IACrB,CAAC,CAAC,EAEDvD,eAAe,CAACgB,cAAc,CAACwC,KAAK,CAAC7B,KAAK,EAAEA,KAAK,EAAE;MAClD8B,YAAY,EAAE,SAAAA,aAAA;QAAA,OACZX,YAAY,CAAC,OAAO,EAAAY,MAAA,CAAAC,MAAA;UAClBC,EAAE,EAAEpB,OAAO,CAACD,OAAO;UACnBf,MAAM,EAANA;QAAM,GACHQ,SAAS,CAACL,KAAK,CACnB,CAAC;MAAA;IACN,CAAC,CAAC,eAMF9B,KAAA,CAAAyD,aAAA,CAAC3C,qBAAqB;MAACkD,KAAK,EAAEV;IAAW,GACtCnD,eAAe,CAACgB,cAAc,CAACwC,KAAK,CAAC9B,OAAO,EAAEA,OAAO,IAAI,CAAC,CAAC,EAAE;MAC5D+B,YAAY,EAAE,SAAAA,aAAA;QAAA,OACZX,YAAY,CAAC,SAAS,EAAAY,MAAA,CAAAC,MAAA;UACpBG,KAAK,EAAE,CAAC,CAACrC,YAAY,IAAI,IAAI;UAC7BV,GAAG,EAAHA;QAAG,GACAoB,cAAc,EACdH,SAAS,CAACN,OAAO,CACrB,CAAC;MAAA;IACN,CAAC,CACoB,CAAC,EACvB1B,eAAe,CAACgB,cAAc,CAACwC,KAAK,CAACjC,OAAO,EAAEE,YAAY,IAAIF,OAAO,EAAE;MACtEkC,YAAY,EAAE,SAAAA,aAAA;QAAA,OACZX,YAAY,CAAC,SAAS,EAAAY,MAAA,CAAAC,MAAA;UACpBC,EAAE,EAAEvB,SAAS,CAACE;QAAO,GAClBP,SAAS,CAACT,OAAO,CACrB,CAAC;MAAA;IACN,CAAC,CACU,CACd;IACDD,MAAM,CAAC,CAAC;IACR,OAAO+B,OAAO;EAChB,CAAC,EACD;IACEzB,SAAS,EAAEhB,sBAAsB;IACjCO,WAAW,EAAE,eAAe;IAC5BqC,KAAK,EAAE;MACL7B,KAAK,EAAElB,SAAS;MAChBc,OAAO,EAAEb,WAAW;MACpBgB,OAAO,EAAEzB;IACX,CAAC;IACDmC,YAAY,EAAE,CACZ,IAAI,EACJ,eAAe,EACf,WAAW,EACX,WAAW,EACX,QAAQ,EACR,QAAQ,EACR,QAAQ,EACR,cAAc,EACd,SAAS,CACV;IACD2B,eAAe,EAAE;MACfC,UAAU,EAAE;IACd;EACF,CACF,CAAC;EAEDnD,cAAc,CAACoD,SAAS,GAAAP,MAAA,CAAAC,MAAA,KACnB7D,eAAe,CAACoE,YAAY,CAAC;IAAEC,QAAQ,EAAE;EAAM,CAAC,CAAC;IACpD3C,MAAM,EAAE5B,SAAS,CAACwE,IAAI;IACtB7C,OAAO,EAAE5B,eAAe,CAAC0E,aAAa;IACtC5C,YAAY,EAAE9B,eAAe,CAAC0E;EAAa,EAC5C;EAEDxD,cAAc,CAAC4C,YAAY,GAAG;IAC5BV,aAAa,EAAErD;EACjB,CAAC;EAAC,OA5HWmB,cAAc;AAAA"}