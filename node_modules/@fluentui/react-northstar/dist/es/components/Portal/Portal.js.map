{"version":3,"file":"Portal.js","names":["FocusTrapZone","useFluentContext","useTelemetry","useAutoControlled","EventListener","handleRef","Ref","customPropTypes","PropTypes","React","childrenExist","doesNodeContainClick","commonPropTypes","rtlTextContainer","createShorthandFactory","PortalInner","Portal","props","context","_useTelemetry","displayName","telemetry","setStart","setEnd","children","content","trapFocus","trigger","triggerAccessibility","portalRef","useRef","triggerRef","_useAutoControlled","defaultValue","defaultOpen","value","open","initialValue","setOpen","renderPortal","contentToRender","focusTrapZoneProps","_keys","length","createElement","innerRef","_extends","onMount","handleMount","onUnmount","handleUnmount","getAttributes","forElements","listener","handleDocumentClick","target","type","renderTrigger","handleTriggerRef","cloneElement","Object","assign","onClick","handleTriggerClick","attributes","keyHandlers","_invoke","node","current","e","_len","arguments","unhandledProps","Array","_key","apply","concat","isOpen","element","Fragment","propTypes","createCommon","accessibility","as","className","styled","bool","func","ref","object","onTriggerClick","onOutsideClick","oneOfType","handledProps","keys","create","Component","defaultProps"],"sources":["components/Portal/Portal.tsx"],"sourcesContent":["import { AccessibilityAttributes } from '@fluentui/accessibility';\nimport {\n  AccessibilityHandlerProps,\n  FocusTrapZone,\n  FocusTrapZoneProps,\n  useFluentContext,\n  useTelemetry,\n  useAutoControlled,\n} from '@fluentui/react-bindings';\nimport { EventListener } from '@fluentui/react-component-event-listener';\nimport { handleRef, Ref } from '@fluentui/react-component-ref';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport * as _ from 'lodash';\nimport { FluentComponentStaticProps } from '../../types';\nimport {\n  childrenExist,\n  doesNodeContainClick,\n  ChildrenComponentProps,\n  commonPropTypes,\n  ContentComponentProps,\n  rtlTextContainer,\n  createShorthandFactory,\n} from '../../utils';\nimport { PortalInner } from './PortalInner';\n\nexport type TriggerAccessibility = {\n  attributes?: AccessibilityAttributes;\n  keyHandlers?: AccessibilityHandlerProps;\n};\n\nexport interface PortalProps extends ChildrenComponentProps, ContentComponentProps {\n  /** Initial value of open. */\n  defaultOpen?: boolean;\n\n  /**\n   * Called when the portal is mounted on the DOM.\n   *\n   * @param data - All props.\n   */\n  onMount?: (props: PortalProps) => void;\n\n  /**\n   * Called when the portal is unmounted from the DOM.\n   *\n   * @param data - All props.\n   */\n  onUnmount?: (props: PortalProps) => void;\n\n  /** Controls whether or not the portal is displayed. */\n  open?: boolean;\n\n  /** Element to be rendered in-place where the portal is defined. */\n  trigger?: JSX.Element;\n\n  /** Controls whether or not focus trap should be applied, using boolean or FocusTrapZoneProps type value */\n  trapFocus?: FocusTrapZoneProps | boolean;\n\n  /** Accessibility behavior object to apply on trigger node. */\n  triggerAccessibility?: TriggerAccessibility;\n\n  /** Sets trigger node to passed ref. */\n  triggerRef?: React.Ref<any>;\n\n  /**\n   * Called when trigger node was clicked.\n   *\n   * @param data - All props.\n   */\n  onTriggerClick?: (e: React.MouseEvent) => void;\n\n  /**\n   * Called when `click` event was invoked outside portal or trigger nodes.\n   *\n   * @param data - All props.\n   */\n  onOutsideClick?: (e: React.MouseEvent) => void;\n}\n\n/**\n * (DEPRECATED) A Portal allows to render children outside of their parent.\n *\n * @deprecated Please use \"Popup\" or \"Dialog\" components instead.\n */\nexport const Portal: React.FC<PortalProps> & FluentComponentStaticProps<PortalProps> = props => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(Portal.displayName, context.telemetry);\n  setStart();\n  const { children, content, trapFocus, trigger, triggerAccessibility } = props;\n  const portalRef = React.useRef<HTMLElement>();\n  const triggerRef = React.useRef<HTMLElement>();\n\n  const [open, setOpen] = useAutoControlled({\n    defaultValue: props.defaultOpen,\n    value: props.open,\n    initialValue: false,\n  });\n\n  const renderPortal = (): JSX.Element | undefined => {\n    const contentToRender = childrenExist(children) ? children : content;\n    const focusTrapZoneProps = (_.keys(trapFocus).length && trapFocus) || {};\n    return (\n      open && (\n        <Ref innerRef={portalRef}>\n          <PortalInner\n            onMount={handleMount}\n            onUnmount={handleUnmount}\n            {...rtlTextContainer.getAttributes({ forElements: [contentToRender] })}\n          >\n            {trapFocus ? <FocusTrapZone {...focusTrapZoneProps}>{contentToRender}</FocusTrapZone> : contentToRender}\n            <EventListener listener={handleDocumentClick} target={context.target} type=\"click\" />\n          </PortalInner>\n        </Ref>\n      )\n    );\n  };\n\n  const renderTrigger = (): JSX.Element | undefined => {\n    return (\n      trigger && (\n        <Ref innerRef={handleTriggerRef}>\n          {React.cloneElement(trigger, {\n            onClick: handleTriggerClick,\n            ...triggerAccessibility.attributes,\n            ...triggerAccessibility.keyHandlers,\n          })}\n        </Ref>\n      )\n    );\n  };\n\n  const handleMount = () => {\n    _.invoke(props, 'onMount', props);\n  };\n\n  const handleUnmount = () => {\n    _.invoke(props, 'onUnmount', props);\n  };\n\n  const handleTriggerRef = (node: HTMLElement) => {\n    triggerRef.current = node;\n    handleRef(props.triggerRef, node);\n  };\n\n  const handleTriggerClick = (e: React.MouseEvent, ...unhandledProps) => {\n    _.invoke(props, 'onTriggerClick', e); // Call handler from parent component\n    _.invoke(trigger, 'props.onClick', e, ...unhandledProps); // Call original event handler\n    setOpen(isOpen => !isOpen);\n  };\n\n  const handleDocumentClick = (e: MouseEvent) => {\n    if (\n      !portalRef || // no portal\n      doesNodeContainClick(triggerRef.current, e, context.target) || // event happened in trigger (delegate to trigger handlers)\n      doesNodeContainClick(portalRef.current, e, context.target) // event happened in the portal\n    ) {\n      return; // ignore the click\n    }\n    _.invoke(props, 'onOutsideClick', e);\n    setOpen(false);\n  };\n\n  const element = (\n    <>\n      {renderPortal()}\n      {renderTrigger()}\n    </>\n  );\n  setEnd();\n  return element;\n};\n\nPortal.propTypes = {\n  ...commonPropTypes.createCommon({\n    accessibility: false,\n    as: false,\n    className: false,\n    styled: false,\n  }),\n  defaultOpen: PropTypes.bool,\n  onMount: PropTypes.func,\n  onUnmount: PropTypes.func,\n  open: PropTypes.bool,\n  trigger: PropTypes.element,\n  triggerRef: customPropTypes.ref,\n  triggerAccessibility: PropTypes.object,\n  onTriggerClick: PropTypes.func,\n  onOutsideClick: PropTypes.func,\n  trapFocus: PropTypes.oneOfType([PropTypes.bool, PropTypes.object]),\n};\n\nPortal.handledProps = Object.keys(Portal.propTypes) as any;\n\nPortal.create = createShorthandFactory({\n  Component: Portal,\n});\n\nPortal.defaultProps = {\n  triggerAccessibility: {},\n};\n"],"mappings":"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"}