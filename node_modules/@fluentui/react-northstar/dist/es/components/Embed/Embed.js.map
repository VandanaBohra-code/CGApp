{"version":3,"file":"Embed.js","names":["embedBehavior","PropTypes","React","customPropTypes","createShorthandFactory","commonPropTypes","Image","Video","Box","Ref","getElementType","useUnhandledProps","useFluentContext","useAutoControlled","useAccessibility","useTelemetry","useStyles","embedClassName","embedSlotClassNames","control","Embed","forwardRef","props","ref","context","_useTelemetry","displayName","telemetry","setStart","setEnd","alt","title","iframe","placeholder","video","variables","styles","className","design","ElementType","unhandledProps","handledProps","getA11yProps","accessibility","debugName","actionHandlers","performClick","event","handleClick","mapPropsToBehavior","rtl","_useAutoControlled","defaultValue","defaultActive","value","active","initialValue","setACtive","_React$useState","useState","iframeLoaded","setIframeLoaded","frameRef","useRef","e","stopPropagation","preventDefault","iframeNil","_isNil","newActive","_invoke","Object","assign","handleFrameOverrides","predefinedProps","onLoad","current","contentWindow","focus","_useStyles","mapPropsToStyles","mapPropsToInlineStyles","classes","resolvedStyles","placeholderElement","createElement","src","image","width","height","hasIframe","hasVideo","controlVisible","placeholderVisible","element","root","onClick","Fragment","create","defaultProps","autoPlay","controls","loop","muted","poster","innerRef","as","overrideProps","propTypes","createCommon","children","content","bool","itemShorthand","every","disallow","onActiveChange","func","string","keys","Component"],"sources":["components/Embed/Embed.tsx"],"sourcesContent":["import { Accessibility, embedBehavior, EmbedBehaviorProps } from '@fluentui/accessibility';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\nimport * as customPropTypes from '@fluentui/react-proptypes';\n\nimport { createShorthandFactory, UIComponentProps, commonPropTypes } from '../../utils';\nimport { Image } from '../Image/Image';\nimport { Video, VideoProps } from '../Video/Video';\nimport { Box, BoxProps } from '../Box/Box';\nimport { ComponentEventHandler, ShorthandValue, FluentComponentStaticProps } from '../../types';\nimport { Ref } from '@fluentui/react-component-ref';\nimport {\n  getElementType,\n  useUnhandledProps,\n  useFluentContext,\n  useAutoControlled,\n  useAccessibility,\n  useTelemetry,\n  useStyles,\n  ForwardRefWithAs,\n} from '@fluentui/react-bindings';\n\nexport interface EmbedSlotClassNames {\n  control: string;\n}\n\nexport interface EmbedProps extends UIComponentProps {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<EmbedBehaviorProps>;\n\n  /** Alternative text. */\n  alt?: string;\n\n  /** Corresponds to HTML title attribute. */\n  title?: string;\n\n  /** Whether the embedded object should be active. */\n  active?: boolean;\n\n  /** Whether the embedded object should start active. */\n  defaultActive?: boolean;\n\n  /** Shorthand for an control. */\n  control?: ShorthandValue<BoxProps>;\n\n  /** Shorthand for an embedded iframe. */\n  iframe?: ShorthandValue<BoxProps>;\n\n  /**\n   * Event for request to change 'active' value.\n   * @param event - React's original SyntheticEvent.\n   * @param data - All props and proposed value.\n   */\n  onActiveChange?: ComponentEventHandler<EmbedProps>;\n\n  /**\n   * Called when is clicked.\n   *\n   * @param event - React's original SyntheticEvent.\n   * @param data - All item props.\n   */\n  onClick?: ComponentEventHandler<EmbedProps>;\n\n  /** Image source URL for when video isn't playing. */\n  placeholder?: string;\n\n  /** Shorthand for an embedded video. */\n  video?: ShorthandValue<VideoProps>;\n}\n\nexport const embedClassName = 'ui-embed';\nexport const embedSlotClassNames: EmbedSlotClassNames = {\n  control: `${embedClassName}__control`,\n};\n\nexport type EmbedStylesProps = Required<Pick<EmbedProps, 'active'>> & { iframeLoaded: boolean };\n\n/**\n * An Embed displays content from external websites, like a post from external social network.\n *\n * @accessibility\n * A `placeholder` slot represents an [`Image`](/components/image/definition) component, please follow recommendations from its\n * accessibility section.\n */\nexport const Embed = React.forwardRef<HTMLSpanElement, EmbedProps>((props, ref) => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(Embed.displayName, context.telemetry);\n  setStart();\n  const { alt, title, control, iframe, placeholder, video, variables, styles, className, design } = props;\n  const ElementType = getElementType(props);\n  const unhandledProps = useUnhandledProps(Embed.handledProps, props);\n\n  const getA11yProps = useAccessibility<EmbedBehaviorProps>(props.accessibility, {\n    debugName: Embed.displayName,\n    actionHandlers: {\n      performClick: event => handleClick(event),\n    },\n    mapPropsToBehavior: () => ({\n      alt,\n      title,\n    }),\n    rtl: context.rtl,\n  });\n\n  const [active, setACtive] = useAutoControlled({\n    defaultValue: props.defaultActive,\n    value: props.active,\n    initialValue: false,\n  });\n\n  const [iframeLoaded, setIframeLoaded] = React.useState(false);\n  const frameRef = React.useRef<HTMLFrameElement>();\n\n  const handleClick = e => {\n    e.stopPropagation();\n    e.preventDefault();\n\n    const iframeNil = _.isNil(props.iframe);\n    const newActive = !active;\n\n    if (iframeNil || (!iframeNil && newActive)) {\n      setACtive(newActive);\n      _.invoke(props, 'onActiveChange', e, { ...props, active: newActive });\n    }\n\n    _.invoke(props, 'onClick', e, { ...props, active: newActive });\n  };\n\n  const handleFrameOverrides = predefinedProps => ({\n    onLoad: (e: React.SyntheticEvent) => {\n      _.invoke(predefinedProps, 'onLoad', e);\n      setIframeLoaded(true);\n      frameRef.current.contentWindow.focus();\n    },\n  });\n\n  const { classes, styles: resolvedStyles } = useStyles<EmbedStylesProps>(Embed.displayName, {\n    className: embedClassName,\n    mapPropsToStyles: () => ({\n      iframeLoaded,\n      active,\n    }),\n    mapPropsToInlineStyles: () => ({\n      className,\n      design,\n      styles,\n      variables,\n    }),\n    rtl: context.rtl,\n  });\n\n  const placeholderElement = placeholder ? (\n    <Image\n      src={placeholder}\n      styles={resolvedStyles.image}\n      variables={{ width: variables.width, height: variables.height }}\n    />\n  ) : null;\n\n  const hasIframe = !_.isNil(iframe);\n  const hasVideo = !_.isNil(video);\n  const controlVisible = !active || hasVideo;\n  const placeholderVisible = !active || (hasIframe && active && !iframeLoaded);\n\n  const element = (\n    <ElementType\n      {...getA11yProps('root', {\n        className: classes.root,\n        onClick: handleClick,\n        ref,\n        ...unhandledProps,\n      })}\n    >\n      {active && (\n        <>\n          {Video.create(video, {\n            defaultProps: () =>\n              getA11yProps('video', {\n                autoPlay: true,\n                controls: false,\n                loop: true,\n                muted: true,\n                poster: placeholder,\n                styles: resolvedStyles.video,\n                variables: {\n                  width: variables.width,\n                  height: variables.height,\n                },\n              }),\n          })}\n          {iframe && (\n            <Ref innerRef={frameRef}>\n              {Box.create(iframe, {\n                defaultProps: () =>\n                  getA11yProps('iframe', {\n                    as: 'iframe',\n                    styles: resolvedStyles.iframe,\n                  }),\n                overrideProps: handleFrameOverrides,\n              })}\n            </Ref>\n          )}\n        </>\n      )}\n\n      {placeholderVisible && placeholderElement}\n      {controlVisible &&\n        Box.create(control, {\n          defaultProps: () =>\n            getA11yProps('control', {\n              className: embedSlotClassNames.control,\n              styles: resolvedStyles.control,\n            }),\n        })}\n    </ElementType>\n  );\n\n  setEnd();\n\n  return element;\n}) as unknown as ForwardRefWithAs<'span', HTMLSpanElement, EmbedProps> & FluentComponentStaticProps<EmbedProps>;\n\nEmbed.displayName = 'Embed';\n\nEmbed.propTypes = {\n  ...commonPropTypes.createCommon({\n    children: false,\n    content: false,\n  }),\n  active: PropTypes.bool,\n  defaultActive: PropTypes.bool,\n  control: customPropTypes.itemShorthand,\n  iframe: customPropTypes.every([customPropTypes.disallow(['video']), customPropTypes.itemShorthand]),\n  onActiveChange: PropTypes.func,\n  onClick: PropTypes.func,\n  placeholder: PropTypes.string,\n  video: customPropTypes.every([customPropTypes.disallow(['iframe']), customPropTypes.itemShorthand]),\n};\n\nEmbed.defaultProps = {\n  as: 'span' as const,\n  accessibility: embedBehavior,\n  control: {},\n  variables: {},\n};\n\nEmbed.handledProps = Object.keys(Embed.propTypes) as any;\n\nEmbed.create = createShorthandFactory({ Component: Embed });\n"],"mappings":"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"}